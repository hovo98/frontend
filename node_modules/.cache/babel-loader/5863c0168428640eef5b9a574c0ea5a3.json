{"ast":null,"code":"import _asyncToGenerator from\"/root/dex/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/root/dex/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/root/dex/frontend/node_modules/@babel/runtime/regenerator/index.js\";import useSharedState from'../hook/useSharedState';import React,{useState,useEffect,useCallback,useMemo}from\"react\";import io from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Tradehistory(){var _useSharedState=useSharedState(),selectedToken=_useSharedState.selectedToken,setSelectedToken=_useSharedState.setSelectedToken;//useState(undefined);\nvar _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),transactions=_React$useState2[0],setTransactions=_React$useState2[1];//useState(undefined);\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),showtr=_useState2[0],setShowTr=_useState2[1];//useState(undefined);\nuseEffect(function(){var socket=undefined;var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var prefix,url,response,rdata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:prefix=window.location.protocol+\"//\"+window.location.hostname;url=prefix+\"/api/getdata?op=transactions&symbol=\"+selectedToken.symbol;_context.next=4;return fetch(url);case 4:response=_context.sent;_context.next=7;return response.json();case 7:rdata=_context.sent;setTransactions(rdata);if(!socket){socket=io(prefix);}else{socket.leaveAll();}socket.emit(\"join\",selectedToken.info.symbol);socket.on(\"transactions\",function(data){setTransactions(data);});case 12:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();if(selectedToken)init();return function(){if(socket){socket.disconnect();}};},[selectedToken]);var changeShow=function changeShow(e){setShowTr(!showtr);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mt-2 mb-2\",role:\"button\",onClick:changeShow,children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-warning text-1\",children:\"Trading History\"}),/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-chevron-down\"})]}),showtr&&/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table text-white table-sm table-borderless\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"text-muted\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Time\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[!transactions||transactions.length==0&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",children:\"Loading...\"})}),transactions===null||transactions===void 0?void 0:transactions.map(function(transaction,idx){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:transaction.isbuy?\"text-success\":\"text-danger\",children:transaction.price}),/*#__PURE__*/_jsx(\"td\",{children:transaction.amount}),/*#__PURE__*/_jsx(\"td\",{children:new Date(transaction.time).toLocaleTimeString()})]},idx);})]})]})})]});}export default Tradehistory;","map":{"version":3,"sources":["/root/dex/frontend/src/component/Transaction.js"],"names":["useSharedState","React","useState","useEffect","useCallback","useMemo","io","Tradehistory","selectedToken","setSelectedToken","transactions","setTransactions","showtr","setShowTr","socket","undefined","init","prefix","window","location","protocol","hostname","url","symbol","fetch","response","json","rdata","leaveAll","emit","info","on","data","disconnect","changeShow","e","length","map","transaction","idx","isbuy","price","amount","Date","time","toLocaleTimeString"],"mappings":"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","sourcesContent":["import useSharedState from '../hook/useSharedState'\r\nimport React ,{useState,useEffect,useCallback,useMemo} from \"react\";\r\nimport io from 'socket.io-client';\r\n\r\n\r\nfunction Tradehistory() {\r\n\r\n  const {selectedToken,setSelectedToken}=useSharedState();//useState(undefined);\r\n  const [transactions,setTransactions]=React.useState([]);//useState(undefined);\r\n  const [showtr,setShowTr]=useState(true);//useState(undefined);\r\n  \r\n  useEffect(() => {\r\n      let socket=undefined;\r\n      const init=async()=>{\r\n        const prefix = window.location.protocol+\"//\"+window.location.hostname;\r\n        const url = prefix+\"/api/getdata?op=transactions&symbol=\"+selectedToken.symbol;\r\n        const response = await fetch(url);\r\n        const rdata = await response.json();\r\n        setTransactions(rdata);\r\n        if(!socket){\r\n          socket = io(prefix);\r\n        }else{\r\n          socket.leaveAll();\r\n        }\r\n        socket.emit(\"join\",selectedToken.info.symbol);\r\n        socket.on(\"transactions\", function(data) {\r\n            setTransactions(data);\r\n        });\r\n      }\r\n      if(selectedToken) init();\r\n      return () => {\r\n        if (socket) {\r\n          socket.disconnect();\r\n        }\r\n      }\r\n  }, [selectedToken]) \r\n  const changeShow=(e)=>{\r\n    setShowTr(!showtr);    \r\n  }\r\n  return (\r\n      <>\r\n                <div className=\"d-flex justify-content-between align-items-center mt-2 mb-2\" role=\"button\" \r\n                  onClick={changeShow}>\r\n                  <span className=\"text-warning text-1\">Trading History</span>\r\n                  <i className=\"bi bi-chevron-down\" />\r\n                </div>\r\n                { showtr &&\r\n                  <div className=\"table-responsive\">\r\n                    <table className=\"table text-white table-sm table-borderless\">\r\n                      <thead className=\"text-muted\">\r\n                        <tr>\r\n                          <th scope=\"col\">Price</th>\r\n                          <th scope=\"col\">Amount</th>\r\n                          <th scope=\"col\">Time</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {!transactions || transactions.length==0 &&\r\n                          <tr>\r\n                            <td colSpan=\"3\">Loading...</td>\r\n                          </tr>\r\n                        }\r\n\r\n                        {transactions?.map((transaction,idx)=>(\r\n                          <tr key={idx}>\r\n                            <td className={transaction.isbuy?\"text-success\":\"text-danger\"}>{transaction.price}</td>\r\n                            <td>{transaction.amount}</td>\r\n                            <td>{(new Date(transaction.time)).toLocaleTimeString()}</td>\r\n                          </tr>\r\n                         ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>                }\r\n\r\n      </>\r\n  );\r\n}\r\n\r\nexport default Tradehistory;\r\n"]},"metadata":{},"sourceType":"module"}