{"ast":null,"code":"import _objectSpread from\"/root/dex/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/root/dex/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/root/dex/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/root/dex/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{Modal}from\"react-bootstrap\";import useSharedState from'../hook/useSharedState';import React,{useState,useEffect,useCallback,useMemo}from\"react\";import{useWeb3React}from'@web3-react/core';import{Web3Provider}from'@ethersproject/providers';import{InjectedConnector}from'@web3-react/injected-connector';import{BigNumber}from'@ethersproject/bignumber';import{WalletConnectConnector}from\"@web3-react/walletconnect-connector\";import{WETH,marketOrder,limitOrder,STAKEFEE,EXECUTOR_FEE,SLIPPAGE}from\"./const\";import{ERC20_ABI}from\"../abi/ERC20\";import{LIMIT_ABI}from\"../abi/LIMIT\";import{MARKET_ABI}from\"../abi/MARKET\";import{PAN_ABI}from\"../abi/PAN\";import{getContract}from\"./contract\";import{fixedLength}from\"./common\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var workChainId=56;function Trading(){var _useWeb3React=useWeb3React(),chainId=_useWeb3React.chainId,account=_useWeb3React.account,activate=_useWeb3React.activate,active=_useWeb3React.active,library=_useWeb3React.library;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showMore=_useState4[0],setShowMore=_useState4[1];var _useState5=useState(SLIPPAGE),_useState6=_slicedToArray(_useState5,2),slippagePractice=_useState6[0],setSlippagePractice=_useState6[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){if(active==false){setShow(true);}};var connectMetamask=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var injectedConnector;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:injectedConnector=new InjectedConnector({supportedChainIds:[1,3,4,42,56,137]});activate(injectedConnector);handleClose();case 3:case\"end\":return _context.stop();}}},_callee);}));return function connectMetamask(){return _ref.apply(this,arguments);};}();var RPC={1:'https://eth-mainnet.alchemyapi.io/v2/q1gSNoSMEzJms47Qn93f9-9Xg5clkmEC',56:'https://bsc.getblock.io/mainnet/?api_key=7b87bee9-86e3-49d9-bd31-aa4bd5efed68'};var connectWalletConnect=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var WalletConnect;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:WalletConnect=new WalletConnectConnector({rpcUrl:RPC,bridge:\"https://bridge.walletconnect.org\",qrcode:true});activate(WalletConnect);handleClose();case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function connectWalletConnect(){return _ref2.apply(this,arguments);};}();var toFixed=function toFixed(_x){var x=Math.floor(_x);if(Math.abs(x)<1.0){var e=parseInt(x.toString().split('e-')[1]);if(e){x*=Math.pow(10,e-1);x='0.'+new Array(e).join('0')+x.toString().substring(2);}}else{var e=parseInt(x.toString().split('+')[1]);if(e>20){e-=20;x/=Math.pow(10,e);x+=new Array(e+1).join('0');}}return x.toString();};var _useState7=useState('market'),_useState8=_slicedToArray(_useState7,2),orderType=_useState8[0],setOrderType=_useState8[1];var _useSharedState=useSharedState(),selectedToken=_useSharedState.selectedToken,setSelectedToken=_useSharedState.setSelectedToken,bnbPrice=_useSharedState.bnbPrice,long=_useSharedState.long,setLong=_useSharedState.setLong,ask=_useSharedState.ask,bid=_useSharedState.bid;//useState(undefined);\nvar _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),priceBuy=_useState10[0],setPriceBuy=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),priceSell=_useState12[0],setPriceSell=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),amountBuy=_useState14[0],setAmountBuy=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),amountSell=_useState16[0],setAmountSell=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),totalSell=_useState18[0],setTotalSell=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),totalBuy=_useState20[0],setTotalBuy=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),timestamp=_useState22[0],setTimestamp=_useState22[1];var _useState23=useState({base:0,quote:0}),_useState24=_slicedToArray(_useState23,2),balances=_useState24[0],setBalances=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),exactIn=_useState26[0],setExactIn=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),disabled=_useState28[0],setDisabled=_useState28[1];var limitContract=getContract(limitOrder,LIMIT_ABI,library,account);var marketContract=getContract(marketOrder,MARKET_ABI,library,account);//const marketContract = getContract(\"0x10ED43C718714eb63d5aA57B78B54704E256024E\", PAN_ABI,library,account);\nvar resetAll=function resetAll(){setAmountBuy(0);setAmountSell(0);setTotalBuy(0);setTotalSell(0);};var setAmountBuyCall=function setAmountBuyCall(value){setAmountBuy(value);setExactIn(false);};var setPercentBuy=function setPercentBuy(value){if(!selectedToken)return;setExactIn(true);if(orderType=='limit'||orderType=='market'){var total=balances.quote*value/(1+STAKEFEE+Number(slippagePractice)/100);setTotalBuy(Number(fixedLength(selectedToken.info.quote!=\"BNB\"?total:total-EXECUTOR_FEE)));}};var setPercentSell=function setPercentSell(value){if(!selectedToken)return;var total=balances.base*value/(1+STAKEFEE+Number(slippagePractice)/100);setAmountSell(Number(fixedLength(selectedToken.info.base!=\"BNB\"?total:total-EXECUTOR_FEE)));};var convertAmount=function convertAmount(value,decimals){return value/Math.pow(10,decimals);};var updateMarketData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var assetIn,assetOut,decimalsIn,decimalsOut,path,_amountIn2,_amountOut2,_amountOut3,_amountOut4,_amountIn,_amountIn3,amountIn,_amountOut,amountOut;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://buy\nconsole.log('update market data');assetIn=selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address;assetOut=selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address;decimalsIn=selectedToken.info.quote==\"BNB\"?WETH.decimals:selectedToken.info.decimals;decimalsOut=selectedToken.info.base==\"BNB\"?WETH.decimals:selectedToken.info.decimals;path=[assetIn,assetOut];if(!exactIn){_context3.next=16;break;}if(!(totalBuy>0)){_context3.next=14;break;}_amountIn2=getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*totalBuy);_context3.next=11;return marketContract.getAmountsOut(_amountIn2,path);case 11:_amountOut2=_context3.sent;_amountOut3=_amountOut2[_amountOut2.length-1];setAmountBuy(Number(fixedLength(convertAmount(Number(_amountOut3),decimalsOut))));case 14:_context3.next=23;break;case 16:if(!(amountBuy>0)){_context3.next=23;break;}_amountOut4=getBigNumber((assetOut==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountBuy);_context3.next=20;return marketContract.getAmountsIn(_amountOut4,path);case 20:_amountIn=_context3.sent;_amountIn3=_amountIn[0];setTotalBuy(Number(fixedLength(convertAmount(Number(_amountIn3),decimalsIn))));case 23://sell\nassetIn=selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address;;assetOut=selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address;;path=[assetIn,assetOut];decimalsIn=selectedToken.info.base==\"BNB\"?WETH.decimals:selectedToken.info.decimals;decimalsOut=selectedToken.info.quote==\"BNB\"?WETH.decimals:selectedToken.info.decimals;if(!(amountSell==0)){_context3.next=32;break;}return _context3.abrupt(\"return\");case 32:amountIn=getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountSell);_context3.next=35;return marketContract.getAmountsOut(amountIn,path);case 35:_amountOut=_context3.sent;amountOut=_amountOut[_amountOut.length-1];setTotalSell(Number(fixedLength(convertAmount(Number(amountOut),decimalsOut))));case 38:case\"end\":return _context3.stop();}}},_callee3);}));return function updateMarketData(){return _ref3.apply(this,arguments);};}();useEffect(function(){var update=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var buy,total;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(orderType=='limit'){if(Number(priceBuy)>0){if(exactIn){buy=Number(fixedLength(Number(totalBuy)/Number(priceBuy)));setAmountBuy(buy);}else{total=Number(fixedLength(Number(amountBuy)*Number(priceBuy)));setTotalBuy(total);}}}else{updateMarketData();}case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function update(){return _ref4.apply(this,arguments);};}();if(selectedToken&&account)update();},[selectedToken,account,priceBuy,amountBuy,totalBuy,orderType]);useEffect(function(){var update=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var total;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(orderType=='limit'){if(Number(priceSell)>0){total=Number(fixedLength(Number(amountSell)*Number(priceSell)));setTotalSell(total);}}else{updateMarketData();}case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function update(){return _ref5.apply(this,arguments);};}();if(selectedToken&&account)update();},[selectedToken,account,priceSell,amountSell,orderType]);var updateBalance=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var contract,ethBalance,tokenBalance,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:contract=getContract(selectedToken.address,ERC20_ABI,library,account);_context6.t0=Number;_context6.next=4;return library.getBalance(account);case 4:_context6.t1=_context6.sent;ethBalance=(0,_context6.t0)(_context6.t1);_context6.t2=Number;_context6.next=9;return contract.balanceOf(account);case 9:_context6.t3=_context6.sent;tokenBalance=(0,_context6.t2)(_context6.t3);ethBalance=Number(fixedLength(ethBalance/Math.pow(10,WETH.decimals)));tokenBalance=Number(fixedLength(tokenBalance/Math.pow(10,selectedToken.info.decimals)));data=_objectSpread({},balances);data.base=selectedToken.info.base==\"BNB\"?ethBalance:tokenBalance;data.quote=selectedToken.info.quote==\"BNB\"?ethBalance:tokenBalance;setBalances(data);case 17:case\"end\":return _context6.stop();}}},_callee6);}));return function updateBalance(){return _ref6.apply(this,arguments);};}();useEffect(function(){var update=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:updateBalance();if(orderType=='market')updateMarketData();setAmountBuy(0);setAmountSell(0);setTotalBuy(0);setTotalSell(0);case 6:case\"end\":return _context7.stop();}}},_callee7);}));return function update(){return _ref7.apply(this,arguments);};}();if(selectedToken&&account)update();},[selectedToken,account,timestamp]);useEffect(function(){library===null||library===void 0?void 0:library.on('block',function(){updateBalance();});return function(){library===null||library===void 0?void 0:library.removeAllListeners('block');};},[library]);var getBigNumber=function getBigNumber(value){return BigNumber.from(toFixed(value));};var getDeadLine=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var timestamp,bn;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:timestamp=0;if(!library){_context8.next=10;break;}_context8.next=4;return library.getBlockNumber();case 4:bn=_context8.sent;_context8.next=7;return library.getBlock(bn);case 7:_context8.t0=_context8.sent.timestamp;_context8.t1=3600*3;timestamp=_context8.t0+_context8.t1;case 10:return _context8.abrupt(\"return\",timestamp);case 11:case\"end\":return _context8.stop();}}},_callee8);}));return function getDeadLine(){return _ref8.apply(this,arguments);};}();var sendMarketOrder=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(assetIn,assetOut,amountIn,amountOut){var deadline,path,options,ai,ao,allowai,contract,result,rt,gasLimit,tx;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:setDisabled(true);console.log({assetIn:assetIn,assetOut:assetOut,amountIn:amountIn,amountOut:amountOut});_context9.prev=2;_context9.next=5;return getDeadLine();case 5:deadline=_context9.sent;path=[assetIn,assetOut];options={gasLimit:0,value:getBigNumber((WETH.address==assetIn?amountIn*(1+STAKEFEE):0)*Math.pow(10,WETH.decimals))};ai=getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountIn);ao=getBigNumber((amountOut==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*(amountOut*(1-Number(slippagePractice)/100)));if(!(WETH.address!=assetIn)){_context9.next=22;break;}allowai=getBigNumber(assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals)*(amountIn*(1+STAKEFEE)));contract=getContract(assetIn,ERC20_ABI,library,account);_context9.next=15;return contract.functions.allowance(account,marketOrder);case 15:result=_context9.sent[0];if(!result.lt(allowai)){_context9.next=22;break;}_context9.next=19;return contract.approve(marketOrder,getBigNumber(Math.pow(2,255)));case 19:rt=_context9.sent;_context9.next=22;return rt.wait();case 22:console.log({assetIn:assetIn,assetOut:assetOut,ai:ai,ao:ao,path:path,options:options});if(!(assetIn==WETH.address)){_context9.next=28;break;}console.log('1');_context9.next=27;return marketContract.estimateGas.myswapExactETHForTokens(ai,ao,path,account,deadline,options);case 27:gasLimit=_context9.sent;case 28:if(!(assetOut==WETH.address)){_context9.next=33;break;}console.log('2');_context9.next=32;return marketContract.estimateGas.swapExactTokensForETH(ai,ao,path,account,deadline,options);case 32:gasLimit=_context9.sent;case 33:if(!(assetIn!=WETH.address&&assetOut!=WETH.address)){_context9.next=38;break;}console.log('3');_context9.next=37;return marketContract.estimateGas.swapExactTokensForTokens(ai,ao,path,account,deadline,options);case 37:gasLimit=_context9.sent;case 38:options.gasLimit=gasLimit;if(!(assetIn==WETH.address)){_context9.next=43;break;}_context9.next=42;return marketContract.myswapExactETHForTokens(ai,ao,path,account,deadline,options);case 42:tx=_context9.sent;case 43:if(!(assetOut==WETH.address)){_context9.next=47;break;}_context9.next=46;return marketContract.swapExactTokensForETH(ai,ao,path,account,deadline,options);case 46:tx=_context9.sent;case 47:if(!(assetIn!=WETH.address&&assetOut!=WETH.address)){_context9.next=51;break;}_context9.next=50;return marketContract.swapExactTokensForTokens(ai,ao,path,account,deadline,options);case 50:tx=_context9.sent;case 51:setAmountBuy(0);setAmountSell(0);setTotalBuy(0);setTotalSell(0);setDisabled(false);return _context9.abrupt(\"return\",tx);case 59:_context9.prev=59;_context9.t0=_context9[\"catch\"](2);setDisabled(false);console.log(_context9.t0);case 63:return _context9.abrupt(\"return\",undefined);case 64:case\"end\":return _context9.stop();}}},_callee9,null,[[2,59]]);}));return function sendMarketOrder(_x2,_x3,_x4,_x5){return _ref9.apply(this,arguments);};}();var sendLimitOrder=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(assetIn,assetOut,amountIn,amountOut){var ordertype,path,options,ai,ao,efee,allowai,contract,result,rt,gasLimit,tx;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:setDisabled(true);console.log({assetIn:assetIn,assetOut:assetOut,amountIn:amountIn,amountOut:amountOut});_context10.prev=2;ordertype=assetIn==WETH.address?0:assetOut==WETH.address?1:2;path=[assetIn,assetOut];options={gasLimit:0,value:getBigNumber((WETH.address==assetIn?amountIn*(1+STAKEFEE)+EXECUTOR_FEE:EXECUTOR_FEE)*Math.pow(10,WETH.decimals))};ai=getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountIn);ao=getBigNumber((amountOut==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountOut);efee=getBigNumber(EXECUTOR_FEE*Math.pow(10,WETH.decimals));if(!(WETH.address!=assetIn)){_context10.next=22;break;}allowai=getBigNumber(assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals)*(amountIn*(1+STAKEFEE)));contract=getContract(assetIn,ERC20_ABI,library,account);_context10.next=14;return contract.functions.allowance(account,limitOrder);case 14:result=_context10.sent[0];if(!result.lt(allowai)){_context10.next=22;break;}console.log({allowai:allowai,result:result});_context10.next=19;return contract.approve(limitOrder,getBigNumber(Math.pow(2,255)));case 19:rt=_context10.sent;_context10.next=22;return rt.tx.wait();case 22:console.log({ordertype:ordertype,assetIn:assetIn,assetOut:assetOut,ai:ai,ao:ao,path:path,efee:efee,options:options});_context10.next=25;return limitContract.estimateGas.createOrder(ordertype,assetIn,assetOut,ai,ao,path,efee,options);case 25:gasLimit=_context10.sent;options.gasLimit=gasLimit;_context10.next=29;return limitContract.createOrder(ordertype,assetIn,assetOut,ai,ao,path,efee,options);case 29:tx=_context10.sent;setAmountBuy(0);setAmountSell(0);setTotalBuy(0);setTotalSell(0);setDisabled(false);return _context10.abrupt(\"return\",tx);case 38:_context10.prev=38;_context10.t0=_context10[\"catch\"](2);setDisabled(false);console.log(_context10.t0);case 42:return _context10.abrupt(\"return\",undefined);case 43:case\"end\":return _context10.stop();}}},_callee10,null,[[2,38]]);}));return function sendLimitOrder(_x6,_x7,_x8,_x9){return _ref10.apply(this,arguments);};}();var onBuy=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var response,regist,_response,_regist;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(!(orderType=='limit')){_context11.next=10;break;}_context11.next=3;return sendLimitOrder(selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,Number(totalBuy),Number(amountBuy));case 3:response=_context11.sent;if(!response){_context11.next=8;break;}_context11.next=7;return fetch(getapiquery(response,'buy','limit',Number(totalBuy),selectedToken.info.quote));case 7:regist=_context11.sent;case 8:_context11.next=17;break;case 10:_context11.next=12;return sendMarketOrder(selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,Number(totalBuy),Number(amountBuy));case 12:_response=_context11.sent;if(!_response){_context11.next=17;break;}_context11.next=16;return fetch(getapiquery(_response,'buy','market',Number(totalBuy),selectedToken.info.quote));case 16:_regist=_context11.sent;case 17:case\"end\":return _context11.stop();}}},_callee11);}));return function onBuy(){return _ref11.apply(this,arguments);};}();var onSell=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(){var response,regist,_response2,_regist2;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(!(orderType=='limit')){_context12.next=10;break;}_context12.next=3;return sendLimitOrder(selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,Number(amountSell),Number(totalSell));case 3:response=_context12.sent;if(!response){_context12.next=8;break;}_context12.next=7;return fetch(getapiquery(response,'sell','limit',Number(amountSell),selectedToken.info.base));case 7:regist=_context12.sent;case 8:_context12.next=17;break;case 10:_context12.next=12;return sendMarketOrder(selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,Number(amountSell),Number(totalSell));case 12:_response2=_context12.sent;if(!_response2){_context12.next=17;break;}_context12.next=16;return fetch(getapiquery(_response2,'sell','market',Number(amountSell),selectedToken.info.base));case 16:_regist2=_context12.sent;case 17:case\"end\":return _context12.stop();}}},_callee12);}));return function onSell(){return _ref12.apply(this,arguments);};}();var getapiquery=function getapiquery(response,side,ordertype,inAmount,inAsset){var apiquery=\"\";if(selectedToken){var trid=response.hash;var prefix=window.location.protocol+\"//\"+window.location.hostname;apiquery=prefix+\"/api/createorder?chainid=56&owner=\"+account+\"&pairs=\"+selectedToken.info.base+selectedToken.info.quote+\"&side=\"+side+\"&transactionid=\"+trid+\"&trstatus=pending&ordertype=\"+ordertype;apiquery=apiquery+\"&orderstatus=executed\";apiquery=apiquery+\"&orderid=0&inAmount=\"+inAmount+\"&inAsset=\"+inAsset;if(ordertype.indexOf(\"market\")>=0){var tokenprice=side=='buy'?Number(fixedLength(Number(totalBuy)/Number(amountBuy))):Number(fixedLength(Number(totalSell)/Number(amountSell)));apiquery=apiquery+\"&price=\"+tokenprice;}else{apiquery=apiquery+\"&price=\"+(side=='buy'?priceBuy:priceSell);}apiquery=apiquery+\"&amount=\"+(side=='buy'?amountBuy:amountSell);console.log(apiquery);}return apiquery;};return/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-lg-4 bg-dark text-white\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mt-2 mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{role:\"button\",className:\"text-1 \"+(orderType=='limit'?\"text-warning\":\"text-muted\"),onClick:function onClick(){setOrderType('limit');resetAll();},children:\"Limit Order\"}),/*#__PURE__*/_jsx(\"div\",{role:\"button\",className:\"text-1 \"+(orderType=='market'?\"text-warning\":\"text-muted\"),onClick:function onClick(){setOrderType('market');resetAll();},children:\"Market Order\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ps-2 pe-2\",id:\"buy-crypto\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"./assets/images/visa.svg\",alt:\"\",width:24,height:24,className:\"d-inline-block\"}),/*#__PURE__*/_jsx(\"img\",{src:\"./assets/images/mastercard.svg\",alt:\"\",width:24,height:24,className:\"d-inline-block\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white smaller-text\",children:\"Buy Crypto\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-6\",children:[orderType=='limit'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"basic-url\",className:\"form-label mb-1 d-flex justify-content-between text-1 text-light\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setPriceBuy(ask);},children:\"Best Ask\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:priceBuy,onChange:function onChange(e){return setPriceBuy(e.currentTarget.value);},className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"Amount (to the nearest dollar)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.quote})]})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"basic-url\",className:\"form-label mb-1 d-flex justify-content-between text-1 text-light\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Amount\"}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",style:{\"padding\":\"3px\"},onClick:function onClick(){return setPercentBuy(0.25);},children:\"25%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",style:{\"padding\":\"3px\"},onClick:function onClick(){return setPercentBuy(0.5);},children:\"50%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",style:{\"padding\":\"3px\"},onClick:function onClick(){return setPercentBuy(0.75);},children:\"75%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",style:{\"padding\":\"3px\"},onClick:function onClick(){return setPercentBuy(1);},children:\"100%\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:amountBuy,onChange:function onChange(e){setAmountBuyCall(e.currentTarget.value);},className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"Amount (to the nearest dollar)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.base})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"basic-url\",className:\"form-label mb-1 d-flex justify-content-between text-1 text-light\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Avbl\\xA0\",balances.quote,selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.quote]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",readOnly:true,value:totalBuy,className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"Amount (to the nearest dollar)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.quote})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-grid mt-3\",children:[active==false&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-buy btn-sm\",type:\"button\",onClick:handleShow,children:\"Connect Wallet\"}),active&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-buy btn-sm\",type:\"button\",disabled:disabled||balances.quote<totalBuy,onClick:onBuy,children:[\"Buy \",selectedToken?selectedToken.info.base:\"\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-6\",children:[orderType=='limit'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"basic-url\",className:\"form-label mb-1 d-flex justify-content-between text-1 text-light\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setPriceSell(bid);},children:\"Best Bid\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:priceSell,onChange:function onChange(e){return setPriceSell(e.currentTarget.value);},className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"Amount (to the nearest dollar)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.quote})]})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"basic-url\",className:\"form-label mb-1 d-flex justify-content-between text-1 text-light\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Amount\"}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setPercentSell(0.25);},style:{\"padding\":\"3px\"},children:\"25%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setPercentSell(0.5);},style:{\"padding\":\"3px\"},children:\"50%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setPercentSell(0.75);},style:{\"padding\":\"3px\"},children:\"75%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setPercentSell(1);},style:{\"padding\":\"3px\"},children:\"100%\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:amountSell,onChange:function onChange(e){setAmountSell(e.currentTarget.value);},className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"Amount (to the nearest dollar)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.base})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"basic-url\",className:\"form-label mb-1 d-flex justify-content-between text-1 text-light\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Avbl\\xA0\",balances.base,selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.base]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",readOnly:true,value:totalSell,className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"Amount (to the nearest dollar)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:selectedToken===null||selectedToken===void 0?void 0:selectedToken.info.quote})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-grid mt-3\",children:[active==false&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sell btn-sm\",type:\"button\",onClick:handleShow,children:\"Connect Wallet \"}),active&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-sell btn-sm\",disabled:disabled||balances.base<amountSell,type:\"button\",onClick:onSell,children:[\"Sell \",selectedToken?selectedToken.info.base:\"\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1  pt-2\",children:/*#__PURE__*/_jsx(\"i\",{class:\"bi bi-gear-fill\",role:\"button\",onClick:function onClick(){return setShowMore(!showMore);}})}),showMore&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-11 \",children:/*#__PURE__*/_jsx(\"div\",{className:\"row text-1 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-9 text-light  pt-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"slip page\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setSlippagePractice(0.1);},style:{\"padding\":\"3px\"},children:\"0.1%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setSlippagePractice(0.3);},style:{\"padding\":\"3px\"},children:\"0.3%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setSlippagePractice(0.75);},style:{\"padding\":\"3px\"},children:\"0.75%\"}),/*#__PURE__*/_jsx(\"a\",{className:\"text-light\",role:\"button\",onClick:function onClick(){return setSlippagePractice(1);},style:{\"padding\":\"3px\"},children:\"1%\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 \",children:/*#__PURE__*/_jsx(\"div\",{className:\"row text-1 \",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm mb-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:slippagePractice,className:\"form-control bg-secondary text-white border-0\",\"aria-label\":\"slippage\",onChange:function onChange(e){return setSlippagePractice(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-secondary text-light border-0\",children:\"%\"})]})})})})]})]}),/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},children:/*#__PURE__*/_jsx(Modal.Title,{children:/*#__PURE__*/_jsx(\"h6\",{className:\"text-center flex-grow-1 text-white\",children:\"Connect Wallet\"})})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-none d-xl-block d-flex align-items-center justify-content-between m-3 p-3 bg-secondary\",\"data-bs-dismiss\":\"modal\",children:[/*#__PURE__*/_jsxs(\"div\",{role:\"button\",onClick:connectMetamask,children:[/*#__PURE__*/_jsx(\"div\",{children:\"Metamask\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fs-6 text-muted\",children:\"Available as a browser extension and as a mobile app, MetaMask equips you with a key vault, secure login, token wallet, and token exchange.\"})]}),/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-boxes text-warning fs-3\"})]}),/*#__PURE__*/_jsxs(\"div\",{role:\"button\",onClick:connectWalletConnect,className:\"d-flex align-items-center justify-content-between m-3 p-3 bg-secondary\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"WalletConnect\"}),/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-water text-primary fs-3\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-warning fs-6 p-3 text-end\",children:\"Don't have a wallet? Click here.\"})]})]})]});}export default Trading;","map":{"version":3,"sources":["/root/dex/frontend/src/component/Trading.js"],"names":["Modal","useSharedState","React","useState","useEffect","useCallback","useMemo","useWeb3React","Web3Provider","InjectedConnector","BigNumber","WalletConnectConnector","WETH","marketOrder","limitOrder","STAKEFEE","EXECUTOR_FEE","SLIPPAGE","ERC20_ABI","LIMIT_ABI","MARKET_ABI","PAN_ABI","getContract","fixedLength","workChainId","Trading","chainId","account","activate","active","library","show","setShow","showMore","setShowMore","slippagePractice","setSlippagePractice","handleClose","handleShow","connectMetamask","injectedConnector","supportedChainIds","RPC","connectWalletConnect","WalletConnect","rpcUrl","bridge","qrcode","toFixed","_x","x","Math","floor","abs","e","parseInt","toString","split","pow","Array","join","substring","orderType","setOrderType","selectedToken","setSelectedToken","bnbPrice","long","setLong","ask","bid","priceBuy","setPriceBuy","priceSell","setPriceSell","amountBuy","setAmountBuy","amountSell","setAmountSell","totalSell","setTotalSell","totalBuy","setTotalBuy","timestamp","setTimestamp","base","quote","balances","setBalances","exactIn","setExactIn","disabled","setDisabled","limitContract","marketContract","resetAll","setAmountBuyCall","value","setPercentBuy","total","Number","info","setPercentSell","convertAmount","decimals","updateMarketData","console","log","assetIn","address","assetOut","decimalsIn","decimalsOut","path","amountIn","getBigNumber","getAmountsOut","_amountOut","amountOut","length","getAmountsIn","_amountIn","update","buy","updateBalance","contract","getBalance","ethBalance","balanceOf","tokenBalance","data","on","removeAllListeners","from","getDeadLine","getBlockNumber","bn","getBlock","sendMarketOrder","deadline","options","gasLimit","ai","ao","allowai","functions","allowance","result","lt","approve","rt","wait","estimateGas","myswapExactETHForTokens","swapExactTokensForETH","swapExactTokensForTokens","tx","undefined","sendLimitOrder","ordertype","efee","createOrder","onBuy","response","fetch","getapiquery","regist","onSell","side","inAmount","inAsset","apiquery","trid","hash","prefix","window","location","protocol","hostname","indexOf","tokenprice","currentTarget","target","display","justifyContent","alignItems"],"mappings":"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","sourcesContent":["import { Modal } from \"react-bootstrap\";\r\nimport useSharedState from '../hook/useSharedState'\r\n\r\nimport React ,{useState,useEffect,useCallback,useMemo} from \"react\";\r\nimport { useWeb3React } from '@web3-react/core'\r\nimport { Web3Provider } from '@ethersproject/providers'\r\nimport { InjectedConnector } from '@web3-react/injected-connector'\r\n\r\nimport { BigNumber } from '@ethersproject/bignumber'\r\n\r\nimport { WalletConnectConnector } from \"@web3-react/walletconnect-connector\";\r\nimport { WETH,marketOrder,limitOrder,STAKEFEE,EXECUTOR_FEE,SLIPPAGE } from \"./const\";\r\nimport {ERC20_ABI} from \"../abi/ERC20\";\r\nimport {LIMIT_ABI} from \"../abi/LIMIT\";\r\nimport {MARKET_ABI} from \"../abi/MARKET\";\r\nimport {PAN_ABI} from \"../abi/PAN\";\r\n\r\nimport {getContract} from \"./contract\";\r\nimport {fixedLength} from \"./common\"\r\n\r\nconst workChainId = 56\r\n\r\nfunction Trading() {\r\n\r\n  const { chainId, account, activate, active,library } = useWeb3React()\r\n  const [show, setShow] = useState(false);\r\n  const [showMore, setShowMore] = useState(false);\r\n  const [slippagePractice,setSlippagePractice] = useState(SLIPPAGE);\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => {\r\n    if(active==false){\r\n      setShow(true);\r\n    }\r\n  }\r\n  const connectMetamask = async()=>{\r\n    const injectedConnector = new InjectedConnector({supportedChainIds: [1,3,4,42,56,137],})\r\n    activate(injectedConnector)\r\n    handleClose();\r\n  }\r\n  const RPC = {\r\n    1: 'https://eth-mainnet.alchemyapi.io/v2/q1gSNoSMEzJms47Qn93f9-9Xg5clkmEC',\r\n    56: 'https://bsc.getblock.io/mainnet/?api_key=7b87bee9-86e3-49d9-bd31-aa4bd5efed68',\r\n  }\r\n  const connectWalletConnect = async()=>{\r\n    const WalletConnect = new WalletConnectConnector({\r\n     rpcUrl: RPC,\r\n     bridge: \"https://bridge.walletconnect.org\",\r\n     qrcode: true,\r\n    });\r\n    activate(WalletConnect)\r\n    handleClose();\r\n  }\r\n  const toFixed = (_x)=> {\r\n    let x=Math.floor(_x)\r\n    if (Math.abs(x) < 1.0) {\r\n      var e = parseInt(x.toString().split('e-')[1]);\r\n      if (e) {\r\n          x *= Math.pow(10,e-1);\r\n          x = '0.' + (new Array(e)).join('0') + x.toString().substring(2);\r\n      }\r\n    } else {\r\n      var e = parseInt(x.toString().split('+')[1]);\r\n      if (e > 20) {\r\n          e -= 20;\r\n          x /= Math.pow(10,e);\r\n          x += (new Array(e+1)).join('0');\r\n      }\r\n    }\r\n    return x.toString();\r\n  }\r\n\r\n\r\n  const [orderType,setOrderType]=useState('market');\r\n  const {selectedToken,setSelectedToken,bnbPrice,long,setLong,ask,bid}=useSharedState();//useState(undefined);\r\n  const [priceBuy,setPriceBuy] = useState(0);\r\n  const [priceSell,setPriceSell] = useState(0);\r\n  const [amountBuy,setAmountBuy] = useState(0);\r\n  const [amountSell,setAmountSell] = useState(0);\r\n  const [totalSell,setTotalSell] = useState(0);\r\n  const [totalBuy,setTotalBuy] = useState(0);\r\n  const [timestamp,setTimestamp] = useState(0);\r\n  const [balances,setBalances] = useState({base:0,quote:0})\r\n  const [exactIn,setExactIn] = useState(false);\r\n  const [disabled,setDisabled] = useState(false);\r\n  const limitContract = getContract(limitOrder, LIMIT_ABI,library,account);\r\n  const marketContract = getContract(marketOrder, MARKET_ABI,library,account);\r\n  //const marketContract = getContract(\"0x10ED43C718714eb63d5aA57B78B54704E256024E\", PAN_ABI,library,account);\r\n  const resetAll = ()=>{\r\n      setAmountBuy(0);\r\n      setAmountSell(0);\r\n      setTotalBuy(0);\r\n      setTotalSell(0);\r\n\r\n  }\r\n  const setAmountBuyCall = (value)=>{\r\n    setAmountBuy(value);\r\n    setExactIn(false);\r\n  }\r\n\r\n  const setPercentBuy = (value)=>{\r\n    if(!selectedToken) return;\r\n    setExactIn(true);\r\n    if((orderType=='limit') || \r\n        orderType=='market'\r\n      ){\r\n        const total =balances.quote*value/(1+STAKEFEE+Number(slippagePractice)/100); \r\n        setTotalBuy(Number(fixedLength(selectedToken.info.quote!=\"BNB\"?total:total-EXECUTOR_FEE)));\r\n    }\r\n  }\r\n  const setPercentSell = (value)=>{\r\n    if(!selectedToken) return;\r\n    const total =balances.base*value/(1+STAKEFEE+Number(slippagePractice)/100); \r\n    setAmountSell(Number(fixedLength(selectedToken.info.base!=\"BNB\"?total:total-EXECUTOR_FEE)));\r\n  }\r\n\r\n  const convertAmount = (value,decimals)=>{\r\n    return value/Math.pow(10,decimals);\r\n  }\r\n  const updateMarketData = async()=>{\r\n    //buy\r\n    console.log('update market data');\r\n    let assetIn = selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address;\r\n    let assetOut = selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address;\r\n    let decimalsIn = selectedToken.info.quote==\"BNB\"?WETH.decimals:selectedToken.info.decimals;\r\n    let decimalsOut = selectedToken.info.base==\"BNB\"?WETH.decimals:selectedToken.info.decimals;\r\n    let path = [assetIn,assetOut];\r\n    if(exactIn){\r\n      if(totalBuy>0) {\r\n        const amountIn = getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*totalBuy);\r\n        const _amountOut = await marketContract.getAmountsOut(amountIn, path);\r\n        const amountOut = _amountOut[_amountOut.length-1];\r\n        setAmountBuy(Number(fixedLength(convertAmount(Number(amountOut),decimalsOut))));\r\n      }\r\n    }else{\r\n      if(amountBuy>0) {\r\n        const amountOut = getBigNumber((assetOut==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountBuy);\r\n        const _amountIn = await marketContract.getAmountsIn(amountOut, path);\r\n        const amountIn = _amountIn[0];\r\n        setTotalBuy(Number(fixedLength(convertAmount(Number(amountIn),decimalsIn))));    \r\n      }\r\n    }\r\n    //sell\r\n\r\n    assetIn = selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address;;\r\n    assetOut = selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address;;\r\n    path = [assetIn,assetOut];\r\n    decimalsIn = selectedToken.info.base==\"BNB\"?WETH.decimals:selectedToken.info.decimals;\r\n    decimalsOut = selectedToken.info.quote==\"BNB\"?WETH.decimals:selectedToken.info.decimals;\r\n\r\n    if(amountSell==0) return;\r\n    const amountIn = getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountSell);\r\n    const _amountOut = await marketContract.getAmountsOut(amountIn,path);\r\n    const amountOut = _amountOut[_amountOut.length-1];\r\n    setTotalSell(Number(fixedLength(convertAmount(Number(amountOut),decimalsOut))));\r\n  }\r\n\r\n  useEffect(()=>{\r\n    const update = async()=>{\r\n      if(orderType=='limit'){\r\n        if(Number(priceBuy)>0){\r\n          if(exactIn){\r\n            const buy =Number(fixedLength(Number(totalBuy)/Number(priceBuy))); \r\n            setAmountBuy(buy);\r\n          }else{\r\n            const total =Number(fixedLength(Number(amountBuy)*Number(priceBuy))); \r\n            setTotalBuy(total);\r\n          }\r\n        }\r\n      }else{\r\n        updateMarketData();\r\n      }\r\n    }\r\n    if(selectedToken && account) update();\r\n  },[selectedToken,account,priceBuy,amountBuy,totalBuy,orderType])\r\n\r\n  useEffect(()=>{\r\n    const update = async()=>{\r\n      if(orderType=='limit'){\r\n        if(Number(priceSell)>0){\r\n          const total =Number(fixedLength(Number(amountSell)*Number(priceSell))); \r\n          setTotalSell(total);\r\n        }\r\n      }else{\r\n        updateMarketData();\r\n      }\r\n    }\r\n    if(selectedToken && account) update();\r\n  },[selectedToken,account,priceSell,amountSell,orderType])\r\n\r\n  const updateBalance = async()=>{\r\n      const contract = getContract(selectedToken.address, ERC20_ABI,library,account);\r\n      let ethBalance = Number(await library.getBalance(account));\r\n      let tokenBalance = Number(await contract.balanceOf(account));\r\n      ethBalance = Number(fixedLength(ethBalance / Math.pow(10,WETH.decimals)));\r\n      tokenBalance=Number(fixedLength(tokenBalance / Math.pow(10,selectedToken.info.decimals)));\r\n      let data = {... balances};\r\n      data.base = selectedToken.info.base ==\"BNB\"?ethBalance:tokenBalance;\r\n      data.quote = selectedToken.info.quote ==\"BNB\"?ethBalance:tokenBalance;\r\n      setBalances(data);\r\n  }\r\n  useEffect(()=>{\r\n    const update = async()=>{\r\n      updateBalance();\r\n      if(orderType=='market') updateMarketData();\r\n      setAmountBuy(0);\r\n      setAmountSell(0);\r\n      setTotalBuy(0);\r\n      setTotalSell(0);\r\n\r\n    }\r\n    if(selectedToken && account) update();\r\n  },[selectedToken,account,timestamp]);\r\n\r\n  useEffect(() => {\r\n    library?.on('block', () => {\r\n      updateBalance();\r\n    })\r\n    return () => {\r\n      library?.removeAllListeners('block')\r\n    }\r\n  }, [library])\r\n\r\n  const getBigNumber=(value)=>{\r\n    return(BigNumber.from(toFixed(value)));\r\n  }\r\n  const getDeadLine = async()=>{\r\n    let timestamp =0;\r\n    if(library){\r\n      const bn = await library.getBlockNumber();\r\n      timestamp = (await library.getBlock(bn)).timestamp+3600*3;\r\n    }\r\n    return timestamp;\r\n  }\r\n  const sendMarketOrder=async(assetIn,assetOut,amountIn,amountOut)=>{\r\n    setDisabled(true);\r\n    console.log({assetIn,assetOut,amountIn,amountOut})\r\n\r\n    try{\r\n      let deadline =await getDeadLine();\r\n      const path = [assetIn,assetOut];\r\n      let options = {\r\n            gasLimit : 0,\r\n            value:getBigNumber(\r\n              (WETH.address==assetIn?(amountIn*(1+STAKEFEE)):0)\r\n              *Math.pow(10,WETH.decimals)\r\n              )\r\n      };        \r\n      const ai = getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountIn)\r\n      const ao = getBigNumber((amountOut==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*(amountOut*(1-Number(slippagePractice)/100)));\r\n      if(WETH.address!=assetIn){\r\n        const allowai = getBigNumber(assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals)*(amountIn*(1+STAKEFEE)))\r\n        const contract = getContract(assetIn, ERC20_ABI,library,account);\r\n        const result = (await contract.functions.allowance(account,marketOrder))[0];\r\n        if(result.lt(allowai)){\r\n          const rt = await contract.approve(marketOrder, getBigNumber(Math.pow(2,255)));\r\n          await rt.wait();\r\n        }\r\n      }\r\n      console.log({\r\n        assetIn,\r\n        assetOut,\r\n        ai,\r\n        ao,\r\n        path,\r\n        options})\r\n      let gasLimit;\r\n      if(assetIn==WETH.address) {\r\n        console.log('1')\r\n        gasLimit = await marketContract.estimateGas.myswapExactETHForTokens(ai,ao,path,account,deadline,options);\r\n      }\r\n      if(assetOut==WETH.address) {\r\n        console.log('2')\r\n        gasLimit = await marketContract.estimateGas.swapExactTokensForETH(ai,ao,path,account,deadline,options);\r\n      }\r\n      if (assetIn!=WETH.address && assetOut!=WETH.address){\r\n        console.log('3')\r\n        gasLimit = await marketContract.estimateGas.swapExactTokensForTokens(ai,ao,path,account,deadline,options);\r\n      }\r\n      options.gasLimit = gasLimit;\r\n      let tx;\r\n      if(assetIn==WETH.address) {\r\n        tx = await marketContract.myswapExactETHForTokens(ai,ao,path,account,deadline,options);\r\n      }\r\n      if(assetOut==WETH.address) {\r\n        tx = await marketContract.swapExactTokensForETH(ai,ao,path,account,deadline,options);\r\n      }\r\n      if (assetIn!=WETH.address && assetOut!=WETH.address){\r\n        tx = await marketContract.swapExactTokensForTokens(ai,ao,path,account,deadline,options);\r\n      }\r\n      \r\n      setAmountBuy(0);\r\n      setAmountSell(0);\r\n      setTotalBuy(0);\r\n      setTotalSell(0);\r\n      setDisabled(false);\r\n      return(tx);\r\n    }catch(e){\r\n      setDisabled(false);\r\n      console.log(e)\r\n    }\r\n    return(undefined);\r\n\r\n  }\r\n\r\n  const sendLimitOrder=async(assetIn,assetOut,amountIn,amountOut)=>{\r\n    setDisabled(true);\r\n    console.log({assetIn,assetOut,amountIn,amountOut})\r\n\r\n    try{\r\n      const ordertype = assetIn==WETH.address?0:assetOut==WETH.address?1:2;\r\n      const path = [assetIn,assetOut];\r\n      let options = {\r\n            gasLimit : 0,\r\n            value:getBigNumber(\r\n              (WETH.address==assetIn?(amountIn*(1+STAKEFEE)+EXECUTOR_FEE):EXECUTOR_FEE)\r\n              *Math.pow(10,WETH.decimals)\r\n              )\r\n      };        \r\n      const ai = getBigNumber((assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountIn)\r\n      const ao = getBigNumber((amountOut==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals))*amountOut)\r\n      const efee = getBigNumber(EXECUTOR_FEE*Math.pow(10,WETH.decimals));\r\n      if(WETH.address!=assetIn){\r\n        const allowai = getBigNumber(assetIn==WETH.address?Math.pow(10,WETH.decimals):Math.pow(10,selectedToken.info.decimals)*(amountIn*(1+STAKEFEE)))\r\n        const contract = getContract(assetIn, ERC20_ABI,library,account);\r\n        const result = (await contract.functions.allowance(account,limitOrder))[0];\r\n        if(result.lt(allowai)){\r\n          console.log({allowai,result})\r\n          const rt = await contract.approve(limitOrder, getBigNumber(Math.pow(2,255)));\r\n          await rt.tx.wait();\r\n        }\r\n      }\r\n      console.log({ordertype,\r\n        assetIn,\r\n        assetOut,\r\n        ai,\r\n        ao,\r\n        path,\r\n        efee,\r\n        options})\r\n      const gasLimit = await limitContract.estimateGas.createOrder(ordertype,assetIn,assetOut,ai,ao,path,efee,options)\r\n      options.gasLimit = gasLimit;\r\n      const tx = await limitContract.createOrder(\r\n        ordertype,\r\n        assetIn,\r\n        assetOut,\r\n        ai,\r\n        ao,\r\n        path,\r\n        efee,\r\n        options);\r\n      setAmountBuy(0);\r\n      setAmountSell(0);\r\n      setTotalBuy(0);\r\n      setTotalSell(0);\r\n      setDisabled(false);\r\n      return(tx);\r\n    }catch(e){\r\n      setDisabled(false);\r\n      console.log(e)\r\n    }\r\n    return(undefined);\r\n\r\n  }\r\n\r\n  const onBuy = async()=>{\r\n    if(orderType=='limit'){\r\n      const response = await sendLimitOrder(\r\n        selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,\r\n        selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,\r\n        Number(totalBuy),\r\n        Number(amountBuy)\r\n      )      \r\n      if(response){\r\n        const regist = await fetch(getapiquery(response,'buy','limit',Number(totalBuy),selectedToken.info.quote));\r\n      }\r\n    }else{\r\n      const response = await sendMarketOrder(\r\n        selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,\r\n        selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,\r\n        Number(totalBuy),\r\n        Number(amountBuy)\r\n      )      \r\n      if(response){\r\n        const regist = await fetch(getapiquery(response,'buy','market',Number(totalBuy),selectedToken.info.quote));\r\n      }\r\n    }\r\n  }\r\n\r\n  const onSell = async()=>{\r\n    if(orderType=='limit'){\r\n      const response = await sendLimitOrder(\r\n        selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,\r\n        selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,\r\n        Number(amountSell),\r\n        Number(totalSell)\r\n      )    \r\n      if(response){\r\n        const regist = await fetch(getapiquery(response,'sell','limit',Number(amountSell),selectedToken.info.base));\r\n      }\r\n    }else{\r\n      const response = await sendMarketOrder(\r\n        selectedToken.info.base==\"BNB\"?WETH.address:selectedToken.address,\r\n        selectedToken.info.quote==\"BNB\"?WETH.address:selectedToken.address,\r\n        Number(amountSell),\r\n        Number(totalSell)\r\n      )    \r\n      if(response){\r\n        const regist = await fetch(getapiquery(response,'sell','market',Number(amountSell),selectedToken.info.base));\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  const getapiquery=(response,side,ordertype,inAmount,inAsset)=>{\r\n      let apiquery=\"\";\r\n      if(selectedToken){\r\n          const trid =response.hash;\r\n          const prefix = window.location.protocol+\"//\"+window.location.hostname;\r\n\r\n          apiquery = prefix+\"/api/createorder?chainid=56&owner=\"+account+\r\n               \"&pairs=\"+selectedToken.info.base+selectedToken.info.quote+\"&side=\"+side+\"&transactionid=\"+trid+\"&trstatus=pending&ordertype=\"+ordertype;\r\n          \r\n          apiquery = apiquery+\"&orderstatus=executed\";\r\n          apiquery = apiquery+\"&orderid=0&inAmount=\"+inAmount+\"&inAsset=\"+inAsset;\r\n          if(ordertype.indexOf(\"market\")>=0){\r\n              const tokenprice = (\r\n                    side=='buy'?Number(fixedLength(Number(totalBuy)/Number(amountBuy))):Number(fixedLength(Number(totalSell)/Number(amountSell)))\r\n                  );\r\n              apiquery = apiquery+\"&price=\"+tokenprice;\r\n          }else{\r\n              apiquery = apiquery+\"&price=\"+(\r\n                      side=='buy'?priceBuy:priceSell\r\n              );\r\n          }\r\n          apiquery = apiquery+\"&amount=\"+(\r\n                side=='buy'?amountBuy:amountSell\r\n          );   \r\n          console.log(apiquery);         \r\n      }\r\n  \r\n      return  apiquery;   \r\n  }  \r\n  return (\r\n     <div className=\"col-12 col-lg-4 bg-dark text-white\">\r\n      <div className=\"d-flex justify-content-between align-items-center mt-2 mb-2\">\r\n        <div role=\"button\" className={\"text-1 \"+(orderType=='limit'?\"text-warning\":\"text-muted\")} onClick={()=>{setOrderType('limit');resetAll()}}>Limit Order</div>\r\n        <div role=\"button\" className={\"text-1 \"+(orderType=='market'?\"text-warning\":\"text-muted\")} onClick={()=>{setOrderType('market');resetAll()}}>Market Order</div>\r\n        <div className=\"ps-2 pe-2\" id=\"buy-crypto\">\r\n          <img src=\"./assets/images/visa.svg\" alt=\"\" width={24} height={24} className=\"d-inline-block\" />\r\n          <img src=\"./assets/images/mastercard.svg\" alt=\"\" width={24} height={24} className=\"d-inline-block\" />\r\n          <span className=\"text-white smaller-text\">Buy Crypto</span>\r\n        </div>\r\n      </div>\r\n      <div className=\"row\">\r\n        <div className=\"col-6\">\r\n          {orderType=='limit' && \r\n          <>\r\n            <label htmlFor={\"basic-url\"} className=\"form-label mb-1 d-flex justify-content-between text-1 text-light\">\r\n              <span>Price</span>\r\n              <a className=\"text-light\" role=\"button\" onClick={()=>setPriceBuy(ask)}>Best Ask</a>\r\n            </label>\r\n            <div className=\"input-group input-group-sm mb-1\">\r\n              <input type=\"number\" value={priceBuy} onChange={(e)=>setPriceBuy(e.currentTarget.value)} className=\"form-control bg-secondary text-white border-0\" aria-label=\"Amount (to the nearest dollar)\" />\r\n              <span className=\"input-group-text bg-secondary text-light border-0\">{selectedToken?.info.quote}</span>\r\n            </div>\r\n          </>\r\n          }\r\n\r\n          <label htmlFor={\"basic-url\"} className=\"form-label mb-1 d-flex justify-content-between text-1 text-light\">\r\n            <span>Amount</span>\r\n            <span>\r\n              <a className=\"text-light\" role=\"button\" style={{\"padding\":\"3px\"}} onClick={()=>setPercentBuy(0.25)}>25%</a>\r\n              <a className=\"text-light\" role=\"button\" style={{\"padding\":\"3px\"}} onClick={()=>setPercentBuy(0.5)}>50%</a>\r\n              <a className=\"text-light\" role=\"button\" style={{\"padding\":\"3px\"}} onClick={()=>setPercentBuy(0.75)}>75%</a>\r\n              <a className=\"text-light\" role=\"button\" style={{\"padding\":\"3px\"}} onClick={()=>setPercentBuy(1)}>100%</a>\r\n            </span>\r\n          </label>\r\n          <div className=\"input-group input-group-sm mb-1\">\r\n            <input type=\"number\" value={amountBuy} onChange={(e)=>{setAmountBuyCall(e.currentTarget.value);}}  className=\"form-control bg-secondary text-white border-0\" aria-label=\"Amount (to the nearest dollar)\" />\r\n            <span className=\"input-group-text bg-secondary text-light border-0\">{selectedToken?.info.base}</span>\r\n          </div>\r\n          <label htmlFor={\"basic-url\"} className=\"form-label mb-1 d-flex justify-content-between text-1 text-light\">\r\n            <span>Total</span>\r\n            <span>Avbl&nbsp;{balances.quote}{selectedToken?.info.quote}</span>\r\n\r\n          </label>\r\n          <div className=\"input-group input-group-sm mb-1\">\r\n            <input type=\"number\"  readOnly = {true} value={totalBuy} className=\"form-control bg-secondary text-white border-0\" aria-label=\"Amount (to the nearest dollar)\" />\r\n            <span className=\"input-group-text bg-secondary text-light border-0\">{selectedToken?.info.quote}</span>\r\n          </div>\r\n          <div className=\"d-grid mt-3\">\r\n          {active==false &&\r\n            <button className=\"btn btn-buy btn-sm\" type=\"button\" onClick={handleShow}>Connect Wallet</button>\r\n          }\r\n          {active &&\r\n            <button className=\"btn btn-buy btn-sm\" type=\"button\" disabled={disabled || balances.quote<totalBuy} onClick={onBuy}>Buy {selectedToken?selectedToken.info.base:\"\"}</button>\r\n          }\r\n          </div>\r\n        </div>\r\n        <div className=\"col-6\">\r\n        {orderType=='limit' && \r\n          <>\r\n          <label htmlFor={\"basic-url\"} className=\"form-label mb-1 d-flex justify-content-between text-1 text-light\">\r\n            <span>Price</span>\r\n            <a className=\"text-light\"  role=\"button\" onClick={()=>setPriceSell(bid)}>Best Bid</a>\r\n          </label>\r\n          <div className=\"input-group input-group-sm mb-1\">\r\n            <input type=\"number\" value={priceSell} onChange={(e)=>setPriceSell(e.currentTarget.value)}  className=\"form-control bg-secondary text-white border-0\" aria-label=\"Amount (to the nearest dollar)\" />\r\n            <span className=\"input-group-text bg-secondary text-light border-0\">{selectedToken?.info.quote}</span>\r\n          </div>\r\n          </>\r\n         }\r\n          <label htmlFor={\"basic-url\"} className=\"form-label mb-1 d-flex justify-content-between text-1 text-light\">\r\n            <span>Amount</span>\r\n            <span>\r\n              <a className=\"text-light\" role=\"button\" onClick={()=>setPercentSell(0.25)} style={{\"padding\":\"3px\"}}>25%</a>\r\n              <a className=\"text-light\" role=\"button\" onClick={()=>setPercentSell(0.5)} style={{\"padding\":\"3px\"}}>50%</a>\r\n              <a className=\"text-light\" role=\"button\" onClick={()=>setPercentSell(0.75)} style={{\"padding\":\"3px\"}}>75%</a>\r\n              <a className=\"text-light\" role=\"button\" onClick={()=>setPercentSell(1)}  style={{\"padding\":\"3px\"}}>100%</a>\r\n            </span>\r\n          </label>\r\n          <div className=\"input-group input-group-sm mb-1\">\r\n            <input type=\"number\" value={amountSell} onChange={(e)=>{setAmountSell(e.currentTarget.value);}} className=\"form-control bg-secondary text-white border-0\" aria-label=\"Amount (to the nearest dollar)\" />\r\n            <span className=\"input-group-text bg-secondary text-light border-0\">{selectedToken?.info.base}</span>\r\n          </div>\r\n          <label htmlFor={\"basic-url\"} className=\"form-label mb-1 d-flex justify-content-between text-1 text-light\">\r\n            <span>Total</span>\r\n            <span>Avbl&nbsp;{balances.base}{selectedToken?.info.base}</span>\r\n          </label>\r\n          <div className=\"input-group input-group-sm mb-1\">\r\n            <input type=\"number\"  readOnly = {true} value={totalSell} className=\"form-control bg-secondary text-white border-0\" aria-label=\"Amount (to the nearest dollar)\" />\r\n            <span className=\"input-group-text bg-secondary text-light border-0\">{selectedToken?.info.quote}</span>\r\n          </div>\r\n          <div className=\"d-grid mt-3\">\r\n            {active==false &&\r\n            <button className=\"btn btn-sell btn-sm\" type=\"button\"  onClick={handleShow}>Connect Wallet </button>\r\n            }\r\n            {active &&\r\n            <button className=\"btn btn-sell btn-sm\" disabled={disabled || balances.base<amountSell} type=\"button\" onClick={onSell}>Sell {selectedToken?selectedToken.info.base:\"\"}</button>\r\n            }\r\n\r\n          </div>\r\n        </div>\r\n        <div className=\"col-1  pt-2\">\r\n          <i class=\"bi bi-gear-fill\" role=\"button\"  onClick={()=>setShowMore(!showMore)}></i>\r\n         </div>\r\n         {showMore && \r\n           <>\r\n          <div className=\"col-11 \">\r\n            <div className=\"row text-1 \">\r\n              <div className=\"col-9 text-light  pt-2\">\r\n                <span>slip page</span>\r\n                <a className=\"text-light\" role=\"button\" onClick={()=>setSlippagePractice(0.1)} style={{\"padding\":\"3px\"}}>0.1%</a>\r\n                <a className=\"text-light\" role=\"button\" onClick={()=>setSlippagePractice(0.3)} style={{\"padding\":\"3px\"}}>0.3%</a>\r\n                <a className=\"text-light\" role=\"button\" onClick={()=>setSlippagePractice(0.75)} style={{\"padding\":\"3px\"}}>0.75%</a>\r\n                <a className=\"text-light\" role=\"button\" onClick={()=>setSlippagePractice(1)}  style={{\"padding\":\"3px\"}}>1%</a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"col-12 \">\r\n            <div  className=\"row text-1 \">\r\n              <div className=\"col-6\">\r\n                <div className=\"input-group input-group-sm mb-1\">\r\n                  <input type=\"number\"  value={slippagePractice} className=\"form-control bg-secondary text-white border-0\" aria-label=\"slippage\" onChange={(e)=>setSlippagePractice(e.target.value)}/>\r\n                  <span className=\"input-group-text bg-secondary text-light border-0\">%</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          </>\r\n         }\r\n\r\n\r\n      </div>\r\n        <Modal show={show} onHide={handleClose} \r\n          aria-labelledby=\"contained-modal-title-vcenter\"\r\n          centered\r\n        >      \r\n        <Modal.Header closeButton \r\n          style={{\r\n          display: \"flex\",\r\n          justifyContent: \"center\",\r\n          alignItems: \"center\",\r\n          }}>\r\n            <Modal.Title>\r\n            <h6 className=\"text-center flex-grow-1 text-white\" >Connect Wallet</h6>\r\n            </Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <div className=\"d-none d-xl-block d-flex align-items-center justify-content-between m-3 p-3 bg-secondary\" data-bs-dismiss=\"modal\"  >\r\n              <div role=\"button\" onClick={connectMetamask}>\r\n                <div>Metamask</div>\r\n                <div className=\"fs-6 text-muted\">\r\n                  Available as a browser extension and as a mobile app, MetaMask equips you with a key vault, secure login, token wallet, and token exchange.\r\n                </div>\r\n              </div>\r\n              <i className=\"bi bi-boxes text-warning fs-3\" />\r\n            </div>\r\n            <div role=\"button\" onClick={connectWalletConnect} className=\"d-flex align-items-center justify-content-between m-3 p-3 bg-secondary\">\r\n                <div>WalletConnect</div>\r\n                <i className=\"bi bi-water text-primary fs-3\"></i>\r\n            </div>\r\n\r\n            <div className=\"text-warning fs-6 p-3 text-end\">\r\n              Don't have a wallet? Click here.\r\n            </div>\r\n          </Modal.Body>\r\n        </Modal>      \r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default Trading;\r\n"]},"metadata":{},"sourceType":"module"}