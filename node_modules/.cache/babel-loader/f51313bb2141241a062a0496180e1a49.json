{"ast":null,"code":"var _jsxFileName = \"/root/dex/frontend/src/component/Orderbook.js\",\n    _s = $RefreshSig$();\n\nimport useSharedState from '../hook/useSharedState';\nimport React, { useState, useEffect, useCallback, useMemo } from \"react\";\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst orderbookcount = 9;\n\nfunction Orderbook() {\n  _s();\n\n  const {\n    selectedToken,\n    setSelectedToken,\n    bnbPrice,\n    long,\n    setLong,\n    ask,\n    setAsk,\n    setBid\n  } = useSharedState(); //useState(undefined);\n\n  const [orderbook, setOrderbook] = useState({}); //useState(undefined);\n\n  const fixedLength = y => {\n    let num = y;\n    let prec = 6;\n\n    while (num > 10) {\n      num /= 10;\n      prec--;\n    }\n\n    return y.toFixed(prec);\n  };\n\n  const getPercent = (lst, value) => {\n    let max = Number(lst[0][1]);\n    let min = Number(lst[0][1]);\n    lst.forEach(order => {\n      if (max < Number(order[1])) max = Number(order[1]);\n      if (min > Number(order[1])) min = Number(order[1]);\n    });\n    let percent = max == min ? 0 : (Number(value) - min) / (max - min);\n    console.log({\n      min,\n      max,\n      value,\n      percent\n    });\n    percent = Math.floor(percent * 4) * 25 / 6;\n    return percent;\n  };\n\n  const getUsdValue = ask => {\n    let value = 0;\n\n    if (selectedToken.info.quote == \"BNB\") {\n      value = Number(ask) * bnbPrice;\n    } else {\n      value = bnbPrice;\n    }\n\n    return value;\n  };\n\n  useEffect(() => {\n    let socket = undefined;\n\n    const init = async () => {\n      setOrderbook({});\n      const prefix = window.location.protocol + \"//\" + window.location.hostname;\n      const url = prefix + \"/api/getdata?op=orderbook&symbol=\" + selectedToken.symbol;\n      const response = await fetch(url);\n      const rdata = await response.json();\n      setOrderbook(rdata);\n      setAsk(Number(rdata.asks[0][0]));\n      setBid(Number(rdata.bids[0][0]));\n\n      if (!socket) {\n        socket = io(prefix);\n      } else {\n        socket.leaveAll();\n      }\n\n      socket.emit(\"join\", selectedToken.info.symbol);\n      socket.on(\"orderbook\", function (data) {\n        if (orderbook.bids) {\n          setLong(data.bids[0][0] > Number(orderbook.bids[0][0]));\n        }\n\n        setAsk(Number(data.asks[0][0]));\n        setBid(Number(data.bids[0][0]));\n        setOrderbook(data);\n      });\n    };\n\n    if (selectedToken) init();\n    return () => {\n      if (socket) {\n        socket.disconnect();\n      }\n    };\n  }, [selectedToken]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"order-3 order-lg-3 col-12 col-lg-2 p-1 bg-dark text-white\",\n    children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"nav nav-pills mb-1\",\n      id: \"pills-tab\",\n      role: \"tablist\",\n      children: [/*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"nav-item\",\n        role: \"presentation\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"nav-link bg-transparent\",\n          id: \"pills-graph-tab\",\n          \"data-bs-toggle\": \"pill\",\n          \"data-bs-target\": \"#pills-graph\",\n          type: \"button\",\n          role: \"tab\",\n          \"aria-controls\": \"pills-graph\",\n          \"aria-selected\": \"false\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-graph-up text-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"nav-item\",\n        role: \"presentation\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"nav-link bg-transparent\",\n          id: \"pills-graph-up-tab\",\n          \"data-bs-toggle\": \"pill\",\n          \"data-bs-target\": \"#pills-graph-up\",\n          type: \"button\",\n          role: \"tab\",\n          \"aria-controls\": \"pills-graph-up\",\n          \"aria-selected\": \"false\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-graph-up-arrow text-success\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"nav-item\",\n        role: \"presentation\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"nav-link bg-transparent\",\n          id: \"pills-graph-down-tab\",\n          \"data-bs-toggle\": \"pill\",\n          \"data-bs-target\": \"#pills-graph-down\",\n          type: \"button\",\n          role: \"tab\",\n          \"aria-controls\": \"pills-graph-down\",\n          \"aria-selected\": \"false\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-graph-down-arrow text-danger\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), orderbook.bids && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tab-content\",\n      id: \"pills-graph-tabContent\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-pane fade show active\",\n        id: \"pills-graph\",\n        role: \"tabpanel\",\n        \"aria-labelledby\": \"pills-graph-tab\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-muted\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 105,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 106,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 107,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: function (rows, i, len) {\n                if (orderbook.asks) {\n                  while (i < len) {\n                    rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"text-danger\",\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 117,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][1]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 118,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][1]) * Number(orderbook.asks[len - i - 1][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 119,\n                        columnNumber: 29\n                      }, this)]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 116,\n                      columnNumber: 27\n                    }, this));\n                    i++;\n                  }\n                }\n\n                return rows;\n              }([], 0, orderbookcount)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"h6 \" + (long ? \"text-success\" : \"text-danger\"),\n                  children: [orderbook.asks ? fixedLength(Number(orderbook.asks[0][0])) : \"\", /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"bi bi-arrow-\" + (long ? \"up\" : \"down\")\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 138,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"h6 text-warning\",\n                  children: [\"$\", orderbook.bids ? fixedLength(getUsdValue(orderbook.bids[0][0])) : 0]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-muted\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 151,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: function (rows, i, len) {\n                if (orderbook.bids) {\n                  while (i < len) {\n                    rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"text-success\",\n                        children: fixedLength(Number(orderbook.bids[i][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 163,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.bids[i][1]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.bids[i][1]) * Number(orderbook.bids[i][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 165,\n                        columnNumber: 29\n                      }, this)]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 162,\n                      columnNumber: 27\n                    }, this));\n                    i++;\n                  }\n                }\n\n                return rows;\n              }([], 0, orderbookcount)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-pane fade\",\n        id: \"pills-graph-down\",\n        role: \"tabpanel\",\n        \"aria-labelledby\": \"pills-graph-down-tab\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-muted\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: function (rows) {\n                if (orderbook.asks) {\n                  const len = orderbook.asks.length;\n                  let i = 0;\n\n                  while (i < len) {\n                    rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"text-danger\",\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 197,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][1]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 198,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][1]) * Number(orderbook.asks[len - i - 1][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 199,\n                        columnNumber: 29\n                      }, this)]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 196,\n                      columnNumber: 27\n                    }, this));\n                    i++;\n                  }\n                }\n\n                return rows;\n              }([])\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-pane fade\",\n        id: \"pills-graph-up\",\n        role: \"tabpanel\",\n        \"aria-labelledby\": \"pills-graph-up-tab\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-muted\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 219,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: function (rows, i, len) {\n                if (orderbook.bids) {\n                  const len = orderbook.bids.length;\n                  let i = 0;\n\n                  while (i < len) {\n                    rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"text-success\",\n                        children: fixedLength(Number(orderbook.bids[i][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 233,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.bids[i][1]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 234,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.bids[i][1]) * Number(orderbook.bids[i][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 235,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"tr-shadow\",\n                        style: {\n                          \"background\": \"rgba(0, 192, 135, 0.15)\",\n                          \"width\": getPercent(orderbook.bids, orderbook.bids[i][1]) + \"%\"\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 236,\n                        columnNumber: 29\n                      }, this)]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 232,\n                      columnNumber: 27\n                    }, this));\n                    i++;\n                  }\n                }\n\n                return rows;\n              }([], 0, 6)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Orderbook, \"pbGJcNViJKg03qBJRTm0WCKHplo=\", false, function () {\n  return [useSharedState];\n});\n\n_c = Orderbook;\nexport default Orderbook;\n\nvar _c;\n\n$RefreshReg$(_c, \"Orderbook\");","map":{"version":3,"sources":["/root/dex/frontend/src/component/Orderbook.js"],"names":["useSharedState","React","useState","useEffect","useCallback","useMemo","io","orderbookcount","Orderbook","selectedToken","setSelectedToken","bnbPrice","long","setLong","ask","setAsk","setBid","orderbook","setOrderbook","fixedLength","y","num","prec","toFixed","getPercent","lst","value","max","Number","min","forEach","order","percent","console","log","Math","floor","getUsdValue","info","quote","socket","undefined","init","prefix","window","location","protocol","hostname","url","symbol","response","fetch","rdata","json","asks","bids","leaveAll","emit","on","data","disconnect","rows","i","len","push","length"],"mappings":"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","sourcesContent":["import useSharedState from '../hook/useSharedState'\r\nimport React ,{useState,useEffect,useCallback,useMemo} from \"react\";\r\nimport io from 'socket.io-client';\r\n\r\nconst orderbookcount =9;\r\n\r\nfunction Orderbook() {\r\n  const {selectedToken,setSelectedToken,bnbPrice,long,setLong,ask,setAsk,setBid}=useSharedState();//useState(undefined);\r\n  const [orderbook,setOrderbook]=useState({});//useState(undefined);\r\n  const fixedLength=(y)=> {\r\n    let num = y;\r\n    let prec = 6;\r\n    while(num > 10) {\r\n        num /= 10;\r\n        prec--;\r\n    }\r\n    return y.toFixed(prec);\r\n  }\r\n  const getPercent = (lst,value)=>{\r\n\r\n    let max = Number(lst[0][1]);\r\n    let min = Number(lst[0][1]);\r\n    lst.forEach((order)=>{\r\n      if(max<Number(order[1])) max = Number(order[1]);\r\n      if(min>Number(order[1])) min = Number(order[1]);\r\n    })\r\n    let percent = max==min?0:(Number(value)-min)/(max-min);\r\n    console.log({min,max,value,percent})\r\n    percent = Math.floor(percent*4) *25/6;\r\n    return(percent)\r\n\r\n  }\r\n  const getUsdValue = (ask)=>{\r\n    let value =0;\r\n    if(selectedToken.info.quote==\"BNB\"){\r\n      value = Number(ask)*bnbPrice;\r\n    }else{\r\n      value = bnbPrice;\r\n    }\r\n    return(value);\r\n  }\r\n  useEffect(() => {\r\n      let socket=undefined;\r\n      const init=async()=>{\r\n        setOrderbook({});\r\n        const prefix = window.location.protocol+\"//\"+window.location.hostname;\r\n        const url = prefix+\"/api/getdata?op=orderbook&symbol=\"+selectedToken.symbol;\r\n        const response = await fetch(url);\r\n        const rdata = await response.json();\r\n        setOrderbook(rdata);\r\n        setAsk(Number(rdata.asks[0][0]));\r\n        setBid(Number(rdata.bids[0][0]));\r\n        \r\n        if(!socket){\r\n          socket = io(prefix);\r\n        }else{\r\n          socket.leaveAll();\r\n        }\r\n        socket.emit(\"join\",selectedToken.info.symbol);\r\n        socket.on(\"orderbook\", function(data) {\r\n            if(orderbook.bids){\r\n                setLong(data.bids[0][0]>Number(orderbook.bids[0][0]));\r\n            }\r\n            setAsk(Number(data.asks[0][0]));\r\n            setBid(Number(data.bids[0][0]));\r\n\r\n            setOrderbook(data);\r\n        });\r\n      }\r\n      if(selectedToken) init();\r\n      return () => {\r\n        if (socket) {\r\n          socket.disconnect();\r\n        }\r\n      }\r\n  }, [selectedToken]) \r\n\r\n  return (\r\n  <div className=\"order-3 order-lg-3 col-12 col-lg-2 p-1 bg-dark text-white\">\r\n      <ul className=\"nav nav-pills mb-1\" id=\"pills-tab\" role=\"tablist\">\r\n        <li className=\"nav-item\" role=\"presentation\">\r\n          <button className=\"nav-link bg-transparent\" id=\"pills-graph-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#pills-graph\" type=\"button\" role=\"tab\" aria-controls=\"pills-graph\" aria-selected=\"false\">\r\n            <i className=\"bi bi-graph-up text-white\" />\r\n          </button>\r\n        </li>\r\n        <li className=\"nav-item\" role=\"presentation\">\r\n          <button className=\"nav-link bg-transparent\" id=\"pills-graph-up-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#pills-graph-up\" type=\"button\" role=\"tab\" aria-controls=\"pills-graph-up\" aria-selected=\"false\">\r\n            <i className=\"bi bi-graph-up-arrow text-success\" />\r\n          </button>\r\n        </li>\r\n        <li className=\"nav-item\" role=\"presentation\">\r\n          <button className=\"nav-link bg-transparent\" id=\"pills-graph-down-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#pills-graph-down\" type=\"button\" role=\"tab\" aria-controls=\"pills-graph-down\" aria-selected=\"false\">\r\n            <i className=\"bi bi-graph-down-arrow text-danger\" />\r\n          </button>\r\n        </li>\r\n      </ul>\r\n      {orderbook.bids && \r\n\r\n      <div className=\"tab-content\" id=\"pills-graph-tabContent\">\r\n        <div className=\"tab-pane fade show active\" id=\"pills-graph\" role=\"tabpanel\" aria-labelledby=\"pills-graph-tab\">\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <thead className=\"text-muted\">\r\n                <tr>\r\n                  <th scope=\"col\">Price</th>\r\n                  <th scope=\"col\">Amount</th>\r\n                  <th scope=\"col\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                { \r\n                  (function (rows, i, len) {\r\n                    if(orderbook.asks){\r\n                      while (i < len) {\r\n                        rows.push(\r\n                          <tr key={i}>\r\n                            <td className=\"text-danger\">{fixedLength(Number(orderbook.asks[len-i-1][0]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.asks[len-i-1][1]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.asks[len-i-1][1])*Number(orderbook.asks[len-i-1][0]))}</td>\r\n\r\n                          </tr>\r\n                        );\r\n                        i++;\r\n                      }\r\n                    }\r\n                    return rows;\r\n                  })([], 0, orderbookcount)\r\n                }\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <tbody>\r\n                <tr>\r\n                  <td className={\"h6 \"+(long?\"text-success\":\"text-danger\")}>\r\n                    {orderbook.asks ? fixedLength(Number(orderbook.asks[0][0])):\"\"}\r\n                    <i className={\"bi bi-arrow-\"+(long?\"up\":\"down\")} />\r\n                  </td>\r\n                  <td className=\"h6 text-warning\">\r\n                    ${orderbook.bids ? fixedLength(getUsdValue(orderbook.bids[0][0])):0}\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <thead className=\"text-muted\">\r\n                <tr>\r\n                  <th scope=\"col\">Price</th>\r\n                  <th scope=\"col\">Amount</th>\r\n                  <th scope=\"col\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                { \r\n                  (function (rows, i, len) {\r\n                    if(orderbook.bids){\r\n                      while (i < len) {\r\n                        rows.push(\r\n                          <tr key={i}>\r\n                            <td className=\"text-success\">{fixedLength(Number(orderbook.bids[i][0]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.bids[i][1]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.bids[i][1])*Number(orderbook.bids[i][0]))}</td>\r\n                          </tr>\r\n                        );\r\n                        i++;\r\n                      }\r\n                    }\r\n                    return rows;\r\n                  })([], 0, orderbookcount)\r\n                }\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className=\"tab-pane fade\" id=\"pills-graph-down\" role=\"tabpanel\" aria-labelledby=\"pills-graph-down-tab\">\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <thead className=\"text-muted\">\r\n                <tr>\r\n                  <th scope=\"col\">Price</th>\r\n                  <th scope=\"col\">Amount</th>\r\n                  <th scope=\"col\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                { \r\n                  (function (rows) {\r\n                    if(orderbook.asks){\r\n                      const len = orderbook.asks.length;\r\n                      let i=0;\r\n                      while (i < len) {\r\n                        rows.push(\r\n                          <tr key={i}>\r\n                            <td className=\"text-danger\">{fixedLength(Number(orderbook.asks[len-i-1][0]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.asks[len-i-1][1]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.asks[len-i-1][1])*Number(orderbook.asks[len-i-1][0]))}</td>\r\n\r\n                          </tr>\r\n                        );\r\n                        i++;\r\n                      }\r\n                    }\r\n                    return rows;\r\n                  })([])\r\n                }\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className=\"tab-pane fade\" id=\"pills-graph-up\" role=\"tabpanel\" aria-labelledby=\"pills-graph-up-tab\">\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <thead className=\"text-muted\">\r\n                <tr>\r\n                  <th scope=\"col\">Price</th>\r\n                  <th scope=\"col\">Amount</th>\r\n                  <th scope=\"col\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                { \r\n                  (function (rows, i, len) {\r\n                    if(orderbook.bids){\r\n                      const len =  orderbook.bids.length;\r\n                      let i=0;\r\n\r\n                      while (i < len) {\r\n                        rows.push(\r\n                          <tr key={i}>\r\n                            <td className=\"text-success\">{fixedLength(Number(orderbook.bids[i][0]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.bids[i][1]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.bids[i][1])*Number(orderbook.bids[i][0]))}</td>\r\n                            <td className=\"tr-shadow\" style={{\"background\": \"rgba(0, 192, 135, 0.15)\", \"width\": getPercent(orderbook.bids,orderbook.bids[i][1])+\"%\"}}></td>\r\n\r\n                          </tr>\r\n                        );\r\n                        i++;\r\n                      }\r\n                    }\r\n                    return rows;\r\n                  })([], 0, 6)\r\n                }\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Orderbook;\r\n"]},"metadata":{},"sourceType":"module"}