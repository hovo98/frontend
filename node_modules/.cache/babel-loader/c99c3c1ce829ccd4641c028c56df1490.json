{"ast":null,"code":"var _jsxFileName = \"/root/dex/frontend/src/component/Transaction.js\",\n    _s = $RefreshSig$();\n\nimport useSharedState from '../hook/useSharedState';\nimport React, { useState, useEffect, useCallback, useMemo } from \"react\";\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Tradehistory() {\n  _s();\n\n  const {\n    selectedToken,\n    setSelectedToken\n  } = useSharedState(); //useState(undefined);\n\n  const [transactions, setTransactions] = React.useState([]); //useState(undefined);\n\n  const [showtr, setShowTr] = useState(true); //useState(undefined);\n\n  useEffect(() => {\n    let socket = undefined;\n\n    const init = async () => {\n      const prefix = window.location.protocol + \"//\" + window.location.hostname;\n      const url = prefix + \"/api/getdata?op=transactions&symbol=\" + selectedToken.symbol;\n      const response = await fetch(url);\n      const rdata = await response.json();\n      setTransactions(rdata);\n\n      if (!socket) {\n        socket = io(prefix);\n      } else {\n        socket.leaveAll();\n      }\n\n      socket.emit(\"join\", selectedToken.info.symbol);\n      socket.on(\"transactions\", function (data) {\n        setTransactions(data);\n      });\n    };\n\n    if (selectedToken) init();\n    return () => {\n      if (socket) {\n        socket.disconnect();\n      }\n    };\n  }, [selectedToken]);\n\n  const changeShow = e => {\n    setShowTr(!showtr);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mt-2 mb-2\",\n      role: \"button\",\n      onClick: changeShow,\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-warning text-1\",\n        children: \"Trading History\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"bi bi-chevron-down\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 17\n    }, this), showtr && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-responsive\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table text-white table-sm table-borderless\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"text-muted\",\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Price\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 52,\n              columnNumber: 27\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Amount\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 53,\n              columnNumber: 27\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Time\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 54,\n              columnNumber: 27\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [!transactions || transactions.length == 0 && /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: \"3\",\n              children: \"Loading...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 27\n          }, this), transactions === null || transactions === void 0 ? void 0 : transactions.map((transaction, idx) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: transaction.isbuy ? \"text-success\" : \"text-danger\",\n              children: transaction.price\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: transaction.amount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: new Date(transaction.time).toLocaleTimeString()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 29\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 27\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 19\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Tradehistory, \"1knR/Th7eJZD4Qmeedq/WWVRvvE=\", false, function () {\n  return [useSharedState];\n});\n\n_c = Tradehistory;\nexport default Tradehistory;\n\nvar _c;\n\n$RefreshReg$(_c, \"Tradehistory\");","map":{"version":3,"sources":["/root/dex/frontend/src/component/Transaction.js"],"names":["useSharedState","React","useState","useEffect","useCallback","useMemo","io","Tradehistory","selectedToken","setSelectedToken","transactions","setTransactions","showtr","setShowTr","socket","undefined","init","prefix","window","location","protocol","hostname","url","symbol","response","fetch","rdata","json","leaveAll","emit","info","on","data","disconnect","changeShow","e","length","map","transaction","idx","isbuy","price","amount","Date","time","toLocaleTimeString"],"mappings":"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","sourcesContent":["import useSharedState from '../hook/useSharedState'\r\nimport React ,{useState,useEffect,useCallback,useMemo} from \"react\";\r\nimport io from 'socket.io-client';\r\n\r\n\r\nfunction Tradehistory() {\r\n\r\n  const {selectedToken,setSelectedToken}=useSharedState();//useState(undefined);\r\n  const [transactions,setTransactions]=React.useState([]);//useState(undefined);\r\n  const [showtr,setShowTr]=useState(true);//useState(undefined);\r\n  \r\n  useEffect(() => {\r\n      let socket=undefined;\r\n      const init=async()=>{\r\n        const prefix = window.location.protocol+\"//\"+window.location.hostname;\r\n        const url = prefix+\"/api/getdata?op=transactions&symbol=\"+selectedToken.symbol;\r\n        const response = await fetch(url);\r\n        const rdata = await response.json();\r\n        setTransactions(rdata);\r\n        if(!socket){\r\n          socket = io(prefix);\r\n        }else{\r\n          socket.leaveAll();\r\n        }\r\n        socket.emit(\"join\",selectedToken.info.symbol);\r\n        socket.on(\"transactions\", function(data) {\r\n            setTransactions(data);\r\n        });\r\n      }\r\n      if(selectedToken) init();\r\n      return () => {\r\n        if (socket) {\r\n          socket.disconnect();\r\n        }\r\n      }\r\n  }, [selectedToken]) \r\n  const changeShow=(e)=>{\r\n    setShowTr(!showtr);    \r\n  }\r\n  return (\r\n      <>\r\n                <div className=\"d-flex justify-content-between align-items-center mt-2 mb-2\" role=\"button\" \r\n                  onClick={changeShow}>\r\n                  <span className=\"text-warning text-1\">Trading History</span>\r\n                  <i className=\"bi bi-chevron-down\" />\r\n                </div>\r\n                { showtr &&\r\n                  <div className=\"table-responsive\">\r\n                    <table className=\"table text-white table-sm table-borderless\">\r\n                      <thead className=\"text-muted\">\r\n                        <tr>\r\n                          <th scope=\"col\">Price</th>\r\n                          <th scope=\"col\">Amount</th>\r\n                          <th scope=\"col\">Time</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {!transactions || transactions.length==0 &&\r\n                          <tr>\r\n                            <td colSpan=\"3\">Loading...</td>\r\n                          </tr>\r\n                        }\r\n\r\n                        {transactions?.map((transaction,idx)=>(\r\n                          <tr key={idx}>\r\n                            <td className={transaction.isbuy?\"text-success\":\"text-danger\"}>{transaction.price}</td>\r\n                            <td>{transaction.amount}</td>\r\n                            <td>{(new Date(transaction.time)).toLocaleTimeString()}</td>\r\n                          </tr>\r\n                         ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>                }\r\n\r\n      </>\r\n  );\r\n}\r\n\r\nexport default Tradehistory;\r\n"]},"metadata":{},"sourceType":"module"}