{"ast":null,"code":"var _jsxFileName = \"/root/dex/frontend/src/component/Orderbook.js\",\n    _s = $RefreshSig$();\n\nimport useSharedState from '../hook/useSharedState';\nimport React, { useState, useEffect, useCallback, useMemo } from \"react\";\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst orderbookcount = 9;\n\nfunction Orderbook() {\n  _s();\n\n  const {\n    selectedToken,\n    setSelectedToken,\n    bnbPrice,\n    long,\n    setLong,\n    ask,\n    setAsk,\n    setBid\n  } = useSharedState(); //useState(undefined);\n\n  const [orderbook, setOrderbook] = useState({}); //useState(undefined);\n\n  const fixedLength = y => {\n    let num = y;\n    let prec = 6;\n\n    while (num > 10) {\n      num /= 10;\n      prec--;\n    }\n\n    return y.toFixed(prec);\n  };\n\n  const getPercent = (lst, value, start, end) => {\n    let max = Number(lst[0][1]);\n    let min = Number(lst[0][1]);\n\n    for (let i = start; i <= end; i++) {\n      const order = lst[i];\n      if (max < Number(order[1])) max = Number(order[1]);\n      if (min > Number(order[1])) min = Number(order[1]);\n    }\n\n    let percent = max == min ? 0 : (Number(value) - min) / (max - min);\n    percent = Math.floor(percent * 4) * 25; // if(window.innerWidth > 992) {\n    //   percent=percent/6;\n    // }else{\n    //   percent=percent/2;\n    // }\n    //if(window.innerWidth <= 760) percent=percent/2;\n\n    return percent;\n  };\n\n  const getUsdValue = ask => {\n    let value = 0;\n\n    if (selectedToken.info.quote == \"BNB\") {\n      value = Number(ask) * bnbPrice;\n    } else {\n      value = bnbPrice;\n    }\n\n    return value;\n  };\n\n  useEffect(() => {\n    let socket = undefined;\n\n    const init = async () => {\n      setOrderbook({});\n      const prefix = window.location.protocol + \"//\" + window.location.hostname;\n      const url = prefix + \"/api/getdata?op=orderbook&symbol=\" + selectedToken.symbol;\n      const response = await fetch(url);\n      const rdata = await response.json();\n      setOrderbook(rdata);\n      setAsk(Number(rdata.asks[0][0]));\n      setBid(Number(rdata.bids[0][0]));\n\n      if (!socket) {\n        socket = io(prefix);\n      } else {\n        socket.leaveAll();\n      }\n\n      socket.emit(\"join\", selectedToken.info.symbol);\n      socket.on(\"orderbook\", function (data) {\n        console.log('long calc', ask, Number(data.asks[0][0]), ask < Number(data.asks[0][0]));\n        setLong(ask < Number(data.asks[0][0]));\n        setAsk(ask => {\n          console.log(ask);\n          return Number(data.asks[0][0]);\n        });\n        setBid(bid => Number(data.bids[0][0]));\n        setOrderbook(data);\n      });\n    };\n\n    if (selectedToken) init();\n    return () => {\n      if (socket) {\n        socket.disconnect();\n      }\n    };\n  }, [selectedToken]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"order-3 order-lg-3 col-12 col-lg-2 p-1 bg-dark text-white\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-none d-xl-block\",\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"nav nav-pills mb-1 \",\n        id: \"pills-tab\",\n        role: \"tablist\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"nav-item\",\n          role: \"presentation\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"nav-link bg-transparent\",\n            id: \"pills-graph-tab\",\n            \"data-bs-toggle\": \"pill\",\n            \"data-bs-target\": \"#pills-graph\",\n            type: \"button\",\n            role: \"tab\",\n            \"aria-controls\": \"pills-graph\",\n            \"aria-selected\": \"false\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"bi bi-graph-up text-white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"nav-item\",\n          role: \"presentation\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"nav-link bg-transparent\",\n            id: \"pills-graph-up-tab\",\n            \"data-bs-toggle\": \"pill\",\n            \"data-bs-target\": \"#pills-graph-up\",\n            type: \"button\",\n            role: \"tab\",\n            \"aria-controls\": \"pills-graph-up\",\n            \"aria-selected\": \"false\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"bi bi-graph-up-arrow text-success\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"nav-item\",\n          role: \"presentation\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"nav-link bg-transparent\",\n            id: \"pills-graph-down-tab\",\n            \"data-bs-toggle\": \"pill\",\n            \"data-bs-target\": \"#pills-graph-down\",\n            type: \"button\",\n            role: \"tab\",\n            \"aria-controls\": \"pills-graph-down\",\n            \"aria-selected\": \"false\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"bi bi-graph-down-arrow text-danger\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), orderbook.bids && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tab-content\",\n      id: \"pills-graph-tabContent\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-pane fade show active\",\n        id: \"pills-graph\",\n        role: \"tabpanel\",\n        \"aria-labelledby\": \"pills-graph-tab\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"xl-6 col-6 col-lg-12\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"table-responsive\",\n              children: /*#__PURE__*/_jsxDEV(\"table\", {\n                className: \"table text-white table-sm table-borderless\",\n                children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                  className: \"text-muted\",\n                  children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                      scope: \"col\",\n                      children: \"Price\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 118,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      scope: \"col\",\n                      children: \"Amount\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 119,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      scope: \"col\",\n                      children: \"Total\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 120,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 117,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 116,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  children: function (rows, i, len) {\n                    if (orderbook.asks) {\n                      while (i < len) {\n                        rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                          style: {\n                            \"position\": \"relative\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"text-danger\",\n                            children: fixedLength(Number(orderbook.asks[len - i - 1][0]))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 130,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: fixedLength(Number(orderbook.asks[len - i - 1][1]))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 131,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: fixedLength(Number(orderbook.asks[len - i - 1][1]) * Number(orderbook.asks[len - i - 1][0]))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 132,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"tr-shadow\",\n                            style: {\n                              \"background\": \"rgba(234, 0, 112, 0.15)\",\n                              \"width\": getPercent(orderbook.asks, orderbook.asks[len - i - 1][1], 0, orderbookcount - 1) + \"%\"\n                            }\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 133,\n                            columnNumber: 31\n                          }, this)]\n                        }, i, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 129,\n                          columnNumber: 29\n                        }, this));\n                        i++;\n                      }\n                    }\n\n                    return rows;\n                  }([], 0, orderbookcount)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 123,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-6 col-lg-12 d-none d-xl-block\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"table-responsive\",\n              children: /*#__PURE__*/_jsxDEV(\"table\", {\n                className: \"table text-white table-sm table-borderless\",\n                children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                      className: \"h6 \" + (long ? \"text-success\" : \"text-danger\"),\n                      children: [orderbook.asks ? fixedLength(Number(orderbook.asks[0][0])) : \"\", /*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-arrow-\" + (long ? \"up\" : \"down\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 154,\n                        columnNumber: 23\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 152,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      className: \"h6 text-warning\",\n                      children: [\"$\", orderbook.bids ? fixedLength(getUsdValue(orderbook.bids[0][0])) : 0]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 156,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 151,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"xl-6 col-6 col-lg-12\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"table-responsive\",\n              children: /*#__PURE__*/_jsxDEV(\"table\", {\n                className: \"table text-white table-sm table-borderless\",\n                children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                  className: \"text-muted\",\n                  children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                      scope: \"col\",\n                      children: \"Price\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 170,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      scope: \"col\",\n                      children: \"Amount\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 171,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      scope: \"col\",\n                      children: \"Total\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 172,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  children: function (rows, i, len) {\n                    if (orderbook.bids) {\n                      while (i < len) {\n                        rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                          style: {\n                            \"position\": \"relative\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"text-success\",\n                            children: fixedLength(Number(orderbook.bids[i][0]))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 182,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: fixedLength(Number(orderbook.bids[i][1]))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 183,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: fixedLength(Number(orderbook.bids[i][1]) * Number(orderbook.bids[i][0]))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 184,\n                            columnNumber: 31\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            className: \"tr-shadow\",\n                            style: {\n                              \"background\": \"rgba(0, 192, 135, 0.15)\",\n                              \"width\": getPercent(orderbook.bids, orderbook.bids[i][1], 0, orderbookcount - 1) + \"%\"\n                            }\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 185,\n                            columnNumber: 31\n                          }, this)]\n                        }, i, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 181,\n                          columnNumber: 29\n                        }, this));\n                        i++;\n                      }\n                    }\n\n                    return rows;\n                  }([], 0, orderbookcount)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-pane fade\",\n        id: \"pills-graph-down\",\n        role: \"tabpanel\",\n        \"aria-labelledby\": \"pills-graph-down-tab\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-muted\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 207,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: function (rows) {\n                if (orderbook.asks) {\n                  const len = orderbook.asks.length;\n                  let i = 0;\n\n                  while (i < len) {\n                    rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      style: {\n                        \"position\": \"relative\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"text-danger\",\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 219,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][1]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 220,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.asks[len - i - 1][1]) * Number(orderbook.asks[len - i - 1][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 221,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"tr-shadow\",\n                        style: {\n                          \"background\": \"rgba(234, 0, 112, 0.15)\",\n                          \"width\": getPercent(orderbook.asks, orderbook.asks[len - i - 1][1], 0, orderbook.asks.length - 1) + \"%\"\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 222,\n                        columnNumber: 29\n                      }, this)]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 218,\n                      columnNumber: 27\n                    }, this));\n                    i++;\n                  }\n                }\n\n                return rows;\n              }([])\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-pane fade\",\n        id: \"pills-graph-up\",\n        role: \"tabpanel\",\n        \"aria-labelledby\": \"pills-graph-up-tab\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table text-white table-sm table-borderless\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"text-muted\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: function (rows, i, len) {\n                if (orderbook.bids) {\n                  const len = orderbook.bids.length;\n                  let i = 0;\n\n                  while (i < len) {\n                    rows.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      style: {\n                        \"position\": \"relative\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"text-success\",\n                        children: fixedLength(Number(orderbook.bids[i][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 255,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.bids[i][1]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 256,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: fixedLength(Number(orderbook.bids[i][1]) * Number(orderbook.bids[i][0]))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 257,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"tr-shadow\",\n                        style: {\n                          \"background\": \"rgba(0, 192, 135, 0.15)\",\n                          \"width\": getPercent(orderbook.bids, orderbook.bids[i][1], 0, orderbook.asks.length - 1) + \"%\"\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 258,\n                        columnNumber: 29\n                      }, this)]\n                    }, i, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 254,\n                      columnNumber: 27\n                    }, this));\n                    i++;\n                  }\n                }\n\n                return rows;\n              }([], 0, 6)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Orderbook, \"pbGJcNViJKg03qBJRTm0WCKHplo=\", false, function () {\n  return [useSharedState];\n});\n\n_c = Orderbook;\nexport default Orderbook;\n\nvar _c;\n\n$RefreshReg$(_c, \"Orderbook\");","map":{"version":3,"sources":["/root/dex/frontend/src/component/Orderbook.js"],"names":["useSharedState","React","useState","useEffect","useCallback","useMemo","io","orderbookcount","Orderbook","selectedToken","setSelectedToken","bnbPrice","long","setLong","ask","setAsk","setBid","orderbook","setOrderbook","fixedLength","y","num","prec","toFixed","getPercent","lst","value","start","end","max","Number","min","i","order","percent","Math","floor","getUsdValue","info","quote","socket","undefined","init","prefix","window","location","protocol","hostname","url","symbol","response","fetch","rdata","json","asks","bids","leaveAll","emit","on","data","console","log","bid","disconnect","rows","len","push","length"],"mappings":"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","sourcesContent":["import useSharedState from '../hook/useSharedState'\r\nimport React ,{useState,useEffect,useCallback,useMemo} from \"react\";\r\nimport io from 'socket.io-client';\r\n\r\nconst orderbookcount =9;\r\n\r\nfunction Orderbook() {\r\n  const {selectedToken,setSelectedToken,bnbPrice,long,setLong,ask,setAsk,setBid}=useSharedState();//useState(undefined);\r\n  const [orderbook,setOrderbook]=useState({});//useState(undefined);\r\n  const fixedLength=(y)=> {\r\n    let num = y;\r\n    let prec = 6;\r\n    while(num > 10) {\r\n        num /= 10;\r\n        prec--;\r\n    }\r\n    return y.toFixed(prec);\r\n  }\r\n  const getPercent = (lst,value,start,end)=>{\r\n\r\n    let max = Number(lst[0][1]);\r\n    let min = Number(lst[0][1]);\r\n    for(let i=start;i<=end;i++){\r\n      const order = lst[i];\r\n      if(max<Number(order[1])) max = Number(order[1]);\r\n      if(min>Number(order[1])) min = Number(order[1]);\r\n\r\n    }\r\n    let percent = max==min?0:(Number(value)-min)/(max-min);\r\n    percent = Math.floor(percent*4) *25;\r\n    // if(window.innerWidth > 992) {\r\n    //   percent=percent/6;\r\n    // }else{\r\n    //   percent=percent/2;\r\n    // }\r\n    //if(window.innerWidth <= 760) percent=percent/2;\r\n\r\n    return(percent)\r\n\r\n  }\r\n  const getUsdValue = (ask)=>{\r\n    let value =0;\r\n    if(selectedToken.info.quote==\"BNB\"){\r\n      value = Number(ask)*bnbPrice;\r\n    }else{\r\n      value = bnbPrice;\r\n    }\r\n    return(value);\r\n  }\r\n  useEffect(() => {\r\n      let socket=undefined;\r\n      const init=async()=>{\r\n        setOrderbook({});\r\n        const prefix = window.location.protocol+\"//\"+window.location.hostname;\r\n        const url = prefix+\"/api/getdata?op=orderbook&symbol=\"+selectedToken.symbol;\r\n        const response = await fetch(url);\r\n        const rdata = await response.json();\r\n        setOrderbook(rdata);\r\n        setAsk(Number(rdata.asks[0][0]));\r\n        setBid(Number(rdata.bids[0][0]));\r\n        \r\n        if(!socket){\r\n          socket = io(prefix);\r\n        }else{\r\n          socket.leaveAll();\r\n        }\r\n        socket.emit(\"join\",selectedToken.info.symbol);\r\n        socket.on(\"orderbook\", function(data) {\r\n            console.log('long calc',ask,Number(data.asks[0][0]),ask<Number(data.asks[0][0]))\r\n            setLong(ask<Number(data.asks[0][0]));\r\n            setAsk((ask)=>{\r\n              console.log(ask);\r\n              return Number(data.asks[0][0])\r\n            });\r\n            setBid((bid)=>Number(data.bids[0][0]));\r\n\r\n            setOrderbook(data);\r\n        });\r\n      }\r\n      if(selectedToken) init();\r\n      return () => {\r\n        if (socket) {\r\n          socket.disconnect();\r\n        }\r\n      }\r\n  }, [selectedToken]) \r\n\r\n  return (\r\n  <div className=\"order-3 order-lg-3 col-12 col-lg-2 p-1 bg-dark text-white\">\r\n      <div className=\"d-none d-xl-block\">\r\n        <ul className=\"nav nav-pills mb-1 \" id=\"pills-tab\" role=\"tablist\">\r\n          <li className=\"nav-item\" role=\"presentation\">\r\n            <button className=\"nav-link bg-transparent\" id=\"pills-graph-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#pills-graph\" type=\"button\" role=\"tab\" aria-controls=\"pills-graph\" aria-selected=\"false\">\r\n              <i className=\"bi bi-graph-up text-white\" />\r\n            </button>\r\n          </li>\r\n          <li className=\"nav-item\" role=\"presentation\">\r\n            <button className=\"nav-link bg-transparent\" id=\"pills-graph-up-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#pills-graph-up\" type=\"button\" role=\"tab\" aria-controls=\"pills-graph-up\" aria-selected=\"false\">\r\n              <i className=\"bi bi-graph-up-arrow text-success\" />\r\n            </button>\r\n          </li>\r\n          <li className=\"nav-item\" role=\"presentation\">\r\n            <button className=\"nav-link bg-transparent\" id=\"pills-graph-down-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#pills-graph-down\" type=\"button\" role=\"tab\" aria-controls=\"pills-graph-down\" aria-selected=\"false\">\r\n              <i className=\"bi bi-graph-down-arrow text-danger\" />\r\n            </button>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      {orderbook.bids && \r\n      <div className=\"tab-content\" id=\"pills-graph-tabContent\">\r\n        <div className=\"tab-pane fade show active\" id=\"pills-graph\" role=\"tabpanel\" aria-labelledby=\"pills-graph-tab\">\r\n          <div className=\"row\">\r\n          <div className=\"xl-6 col-6 col-lg-12\">\r\n            <div className=\"table-responsive\">\r\n              <table className=\"table text-white table-sm table-borderless\">\r\n                <thead className=\"text-muted\">\r\n                  <tr>\r\n                    <th scope=\"col\">Price</th>\r\n                    <th scope=\"col\">Amount</th>\r\n                    <th scope=\"col\">Total</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  { \r\n                    (function (rows, i, len) {\r\n                      if(orderbook.asks){\r\n                        while (i < len) {\r\n                          rows.push(\r\n                            <tr key={i}  style={{\"position\": \"relative\"}}>\r\n                              <td className=\"text-danger\">{fixedLength(Number(orderbook.asks[len-i-1][0]))}</td>\r\n                              <td>{fixedLength(Number(orderbook.asks[len-i-1][1]))}</td>\r\n                              <td>{fixedLength(Number(orderbook.asks[len-i-1][1])*Number(orderbook.asks[len-i-1][0]))}</td>\r\n                              <td className=\"tr-shadow\" style={{\"background\": \"rgba(234, 0, 112, 0.15)\", \"width\": getPercent(orderbook.asks,orderbook.asks[len-i-1][1],0,orderbookcount-1)+\"%\"}}></td>\r\n\r\n                            </tr>\r\n                          );\r\n                          i++;\r\n                        }\r\n                      }\r\n                      return rows;\r\n                    })([], 0, orderbookcount)\r\n                  }\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          <div className=\"col-6 col-lg-12 d-none d-xl-block\">\r\n            <div className=\"table-responsive\">\r\n              <table className=\"table text-white table-sm table-borderless\">\r\n                <tbody>\r\n                  <tr>\r\n                    <td className={\"h6 \"+(long?\"text-success\":\"text-danger\")}>\r\n                      {orderbook.asks ? fixedLength(Number(orderbook.asks[0][0])):\"\"}\r\n                      <i className={\"bi bi-arrow-\"+(long?\"up\":\"down\")} />\r\n                    </td>\r\n                    <td className=\"h6 text-warning\">\r\n                      ${orderbook.bids ? fixedLength(getUsdValue(orderbook.bids[0][0])):0}\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          <div className=\"xl-6 col-6 col-lg-12\">\r\n\r\n            <div className=\"table-responsive\">\r\n              <table className=\"table text-white table-sm table-borderless\">\r\n                <thead className=\"text-muted\">\r\n                  <tr>\r\n                    <th scope=\"col\">Price</th>\r\n                    <th scope=\"col\">Amount</th>\r\n                    <th scope=\"col\">Total</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  { \r\n                    (function (rows, i, len) {\r\n                      if(orderbook.bids){\r\n                        while (i < len) {\r\n                          rows.push(\r\n                            <tr key={i} style={{\"position\": \"relative\"}}>\r\n                              <td className=\"text-success\">{fixedLength(Number(orderbook.bids[i][0]))}</td>\r\n                              <td>{fixedLength(Number(orderbook.bids[i][1]))}</td>\r\n                              <td>{fixedLength(Number(orderbook.bids[i][1])*Number(orderbook.bids[i][0]))}</td>\r\n                              <td className=\"tr-shadow\" style={{\"background\": \"rgba(0, 192, 135, 0.15)\", \"width\": getPercent(orderbook.bids,orderbook.bids[i][1],0,orderbookcount-1)+\"%\"}}></td>\r\n                            </tr>\r\n                          );\r\n                          i++;\r\n                        }\r\n                      }\r\n                      return rows;\r\n                    })([], 0, orderbookcount)\r\n                  }\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"tab-pane fade\" id=\"pills-graph-down\" role=\"tabpanel\" aria-labelledby=\"pills-graph-down-tab\">\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <thead className=\"text-muted\">\r\n                <tr>\r\n                  <th scope=\"col\">Price</th>\r\n                  <th scope=\"col\">Amount</th>\r\n                  <th scope=\"col\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                { \r\n                  (function (rows) {\r\n                    if(orderbook.asks){\r\n                      const len = orderbook.asks.length;\r\n                      let i=0;\r\n                      while (i < len) {\r\n                        rows.push(\r\n                          <tr key={i}  style={{\"position\": \"relative\"}}>\r\n                            <td className=\"text-danger\">{fixedLength(Number(orderbook.asks[len-i-1][0]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.asks[len-i-1][1]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.asks[len-i-1][1])*Number(orderbook.asks[len-i-1][0]))}</td>\r\n                            <td className=\"tr-shadow\" style={{\"background\": \"rgba(234, 0, 112, 0.15)\", \"width\": getPercent(orderbook.asks,orderbook.asks[len-i-1][1],0,orderbook.asks.length-1)+\"%\"}}></td>\r\n                          </tr>\r\n                        );\r\n                        i++;\r\n                      }\r\n                    }\r\n                    return rows;\r\n                  })([])\r\n                }\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className=\"tab-pane fade\" id=\"pills-graph-up\" role=\"tabpanel\" aria-labelledby=\"pills-graph-up-tab\">\r\n          <div className=\"table-responsive\">\r\n            <table className=\"table text-white table-sm table-borderless\">\r\n              <thead className=\"text-muted\">\r\n                <tr>\r\n                  <th scope=\"col\">Price</th>\r\n                  <th scope=\"col\">Amount</th>\r\n                  <th scope=\"col\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                { \r\n                  (function (rows, i, len) {\r\n                    if(orderbook.bids){\r\n                      const len =  orderbook.bids.length;\r\n                      let i=0;\r\n\r\n                      while (i < len) {\r\n                        rows.push(\r\n                          <tr key={i}  style={{\"position\": \"relative\"}}>\r\n                            <td className=\"text-success\">{fixedLength(Number(orderbook.bids[i][0]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.bids[i][1]))}</td>\r\n                            <td>{fixedLength(Number(orderbook.bids[i][1])*Number(orderbook.bids[i][0]))}</td>\r\n                            <td className=\"tr-shadow\" style={{\"background\": \"rgba(0, 192, 135, 0.15)\", \"width\": getPercent(orderbook.bids,orderbook.bids[i][1],0,orderbook.asks.length-1)+\"%\"}}></td>\r\n\r\n                          </tr>\r\n                        );\r\n                        i++;\r\n                      }\r\n                    }\r\n                    return rows;\r\n                  })([], 0, 6)\r\n                }\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Orderbook;\r\n"]},"metadata":{},"sourceType":"module"}